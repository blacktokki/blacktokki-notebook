!function(){let e=null;tinymce.PluginManager.add("supercode",(function(o){let t,n,r,a=0,d=!1;const c={theme:"chrome",fontSize:14,wrap:!0,icon:void 0,iconName:"sourcecode",autocomplete:!1,language:"html",renderer:null,parser:null,shortcut:!0,aceCss:null,fontFamily:null,fallbackModal:!1,modalPrimaryColor:"#ffffff",modalSecondaryColor:"#222f3e",dark:!1,debug:!0},l=()=>{const e={};c.autocomplete&&(e.enableLiveAutocompletion=!0),c.fontFamily&&(e.fontFamily=c.fontFamily),r.setOptions(e),r.setTheme(`ace/theme/${c.theme}`),r.setFontSize(c.fontSize),r.setShowPrintMargin(!1)},i=(e,o)=>{const t=o.cloneNode(!0);t.style.position="relative";const n=t.querySelector(".tox-menubar");n&&(n.innerHTML="<b style='font-size: 14px; font-weight: bold; padding: 11px 9px;'>Source Code Editor</b>");let r=null,a=!1;t.querySelectorAll(".tox-tbtn, .tox-split-button").forEach((e=>{"supercode"!=e.getAttribute("data-mce-name")?("overflow-button"===e.getAttribute("data-mce-name")&&(r=e),e.classList.remove("tox-tbtn--enabled"),e.classList.add("tox-tbtn--disabled"),e.removeAttribute("data-mce-name")):(a=!0,e.setAttribute("data-mce-name","supercode-toggle"),e.classList.add("tox-tbtn--enabled"),e.onclick=m)})),!a&&r&&(r.classList="tox-tbtn tox-tbtn--enabled",r.innerHTML=`<span class="tox-icon tox-tbtn__icon-wrap">${c.icon}</span>`,r.onclick=m),e.innerHTML="",e.append(t)};(e=>{var o,t,n;const r=e.getParam("supercode");if(r&&"object"==typeof r)for(const a in r)if(r.hasOwnProperty(a)){const e=r[a];switch(a){case"theme":case"language":case"iconName":case"aceCss":case"fontFamily":case"modalPrimaryColor":case"modalSecondaryColor":"string"==typeof e&&(c[a]=e);break;case"fontSize":"number"==typeof e&&e>0&&(c.fontSize=parseInt(e));break;case"wrap":case"autocomplete":case"shortcut":case"fallbackModal":case"dark":case"debug":"boolean"==typeof e&&(c[a]=e);break;case"parser":case"renderer":"function"==typeof e&&(c[a]=e)}}c.icon=null==(n=null==(t=(o=e.ui.registry).getAll)?void 0:t.call(o).icons)?void 0:n[c.iconName],c.icon||(c.icon='<svg width="24" height="24" focusable="false"><g fill-rule="nonzero"><path d="M9.8 15.7c.3.3.3.8 0 1-.3.4-.9.4-1.2 0l-4.4-4.1a.8.8 0 0 1 0-1.2l4.4-4.2c.3-.3.9-.3 1.2 0 .3.3.3.8 0 1.1L6 12l3.8 3.7ZM14.2 15.7c-.3.3-.3.8 0 1 .4.4.9.4 1.2 0l4.4-4.1c.3-.3.3-.9 0-1.2l-4.4-4.2a.8.8 0 0 0-1.2 0c-.3.3-.3.8 0 1.1L18 12l-3.8 3.7Z"></path></g></svg>',c.debug&&console.warn("Supercode Icon name is invalid or you are using older versions of tinyMCE. The icon is set to default fallback code icon. \n\nUse debug:false option to disable this warning")),c.fallbackModal||(!0===e.getParam("inline")||tinymce.majorVersion<=5)&&(c.fallbackModal=!0)})(o),(e=>{const o={"ace-default":{url:"https://cdnjs.cloudflare.com/ajax/libs/ace/1.9.6/ace.js",loaded:!1,required:!0},"beautify-html":{url:"https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.15.1/beautify-html.min.js",loaded:!1,required:!0},"ace-autocomplete":{url:"https://cdnjs.cloudflare.com/ajax/libs/ace/1.9.6/ext-language_tools.min.js",loaded:!1,required:!1}};e.autocomplete&&(o["ace-autocomplete"].required=!0),Object.values(o).forEach((e=>{if(e.loaded)return;let o=document.createElement("script");o.src=e.url,o.type="text/javascript",document.body.appendChild(o)}))})(c);const s=e=>{"Escape"===e.key&&u()},u=()=>{c.shortcut&&removeEventListener("keydown",s),document.querySelector("body").classList.remove("disable-scroll"),e.element.style.opacity=0,o.focus(),setTimeout((()=>{e.element.style.display="none"}),10)},p=()=>{o.undoManager.transact((function(){let e=r.getValue();c.renderer&&(e=c.renderer(e)),o.setContent(e)})),o.nodeChanged()},m=()=>{o.focus(),c.fallbackModal&&(o.undoManager.transact((function(){let e=r.getValue();c.renderer&&(e=c.renderer(e)),o.setContent(e)})),o.selection.setCursorLocation(),o.nodeChanged()),o.execCommand("ToggleView",!1,"supercode")},y=e=>{(" "===e.key&&e.ctrlKey||"Escape"===e.key)&&m()},b=()=>{let e=(t=o.getContent(),c.parser?c.parser(t):html_beautify(t));var t;if(!n&&(n=ace.createEditSession(e,`ace/mode/${c.language}`),n.setUseWrapMode(c.wrap),!c.fallbackModal)){const e=(e=>{let o;return(...t)=>{clearTimeout(o),o=setTimeout((()=>e.apply(null,t)),300)}})(p);n.on("change",e)}r.setSession(n),n.setValue(e),r.gotoLine(1/0),r.focus()},h=function(){if(c.fallbackModal)(()=>{var t,n,a;if(!e){const o=document.createElement("div");o.id="supercode-modal-container",o.innerHTML='\n    <div id="supercode-backdrop"></div>\n    <div id="supercode-modal">\n        <div id="supercode-header">\n            <h1>Source Code Editor</h1>\n            <button id="supercode-close-btn">\n                Close\n            </button>\n        </div>\n        <div id="supercode-editor"></div>\n        <div id="supercode-footer">\n            <button id="supercode-cancel-btn">\n                Cancel\n            </button>\n            <button id="supercode-save-btn">\n                Save\n            </button>\n        </div>\n    </div>\n',(()=>{const e=document.createElement("style");e.innerHTML="\n\n    :root{\n        --supercode-modal-primary: #ffffff;\n        --supercode-modal-secondary: #222f3e;\n        --supercode-modal-border: rgba(0, 0, 0, 0.1);\n    }\n\n    /* Media query for mobile devices */\n    @media only screen and (max-width: 767px) {\n        #supercode-modal {\n            width: 100% !important;\n            height: 100% !important;\n            border-radius: 0 !important;\n        }\n    }\n    .disable-scroll {\n        overflow: hidden;\n    }\n    #supercode-modal-container {\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        z-index: 990;\n        display: none;\n        opacity: 0;\n        transition: opacity 0.1s linear;\n    }\n    #supercode-backdrop {\n        position: absolute;\n        top: 0;\n        left: 0;\n        background: black;\n        opacity: 0.7;\n        width: 100%;\n        height: 100%;\n        z-index: 1;\n    }\n    #supercode-modal {\n        width: 90%;\n        height: 80%;\n        max-width: 1200px;\n        z-index: 2;\n        overflow: hidden;\n        border-radius: 10px;\n        display: flex;\n        flex-direction: column;\n        background: var(--supercode-modal-primary);\n    }\n    #supercode-header {\n        display: flex;\n        padding: 0.5rem 1rem;\n        border-bottom: 1px solid var(--supercode-modal-border);\n        color: var(--supercode-modal-secondary);\n    }\n    #supercode-modal h1 {\n        flex-grow: 1;\n        margin: auto;\n        font-size: 14px;\n    }\n    #supercode-close-btn {\n        background: none;\n        border: none;\n        padding: 0;\n        height: 100%;\n        cursor: pointer;\n        fill: var(--supercode-modal-secondary);\n    }\n    #supercode-editor {\n        width: 100%;\n        height: 100%;\n        position: relative;\n    }\n    #supercode-footer {\n        padding: 0.5rem 1rem;\n        display: flex;\n        justify-content: end;\n        gap: 1rem;\n        border-top: 1px solid var(--supercode-modal-border);\n    }\n    #supercode-footer button {\n        padding: 0.5rem 1rem;\n        border-radius: 5px;\n        font-weight: bold;\n        border: none;\n        cursor: pointer;\n        min-width: 5rem;\n        transition: opacity 0.1s linear;\n    }\n    #supercode-footer button:hover {\n        opacity: 0.8;\n    }\n    #supercode-cancel-btn {\n        background: transparent;\n        color: var(--supercode-modal-secondary);\n    }\n    #supercode-save-btn {\n        background: var(--supercode-modal-secondary);\n        color: var(--supercode-modal-primary);\n    }\n    ",document.head.append(e)})(),document.body.append(o),e={element:o,editor:ace.edit(o.querySelector("#supercode-editor"))}}r=e.editor,l(),e.element.querySelector("#supercode-backdrop").onclick=u,e.element.querySelector("#supercode-close-btn").onclick=u,e.element.querySelector("#supercode-cancel-btn").onclick=u,e.element.querySelector("#supercode-save-btn").onclick=()=>{m(),u()},c.shortcut&&e.element.querySelector("#supercode-editor").addEventListener("keydown",s),document.querySelector("body").classList.add("disable-scroll"),document.body.style.setProperty("--supercode-modal-primary",c.modalPrimaryColor),document.body.style.setProperty("--supercode-modal-secondary",c.modalSecondaryColor),c.dark&&document.body.style.setProperty("--supercode-modal-border","rgba(255, 255, 255, 0.1)"),e.element.querySelector("#supercode-close-btn").innerHTML=(null==(a=null==(n=(t=o.ui.registry).getAll)?void 0:n.call(t).icons)?void 0:a.close)??'<svg width="24" height="24"><path d="M17.3 8.2 13.4 12l3.9 3.8a1 1 0 0 1-1.5 1.5L12 13.4l-3.8 3.9a1 1 0 0 1-1.5-1.5l3.9-3.8-3.9-3.8a1 1 0 0 1 1.5-1.5l3.8 3.9 3.8-3.9a1 1 0 0 1 1.5 1.5Z" fill-rule="evenodd"></path></svg>',e.element.style.display="flex",setTimeout((()=>{e.element.style.opacity=1}),10),b()})();else{const e=o.getContainer();a&&(d=a!=e.clientWidth),a=e.clientWidth,!d&&t||(t=e.querySelector(".tox-editor-header")),o.execCommand("ToggleView",!1,"supercode")}};if(!c.fallbackModal){const e={onShow:e=>{const o=e.getContainer();d&&(i(o.querySelector(".supercode-header"),t),o.querySelector(".supercode-body ").style.width=a+"px",r.resize()),0===o.childElementCount&&(o.style.padding=0,o.style.display="flex",o.style.flexDirection="column",o.innerHTML='<div class="supercode-header"></div><div class="supercode-body"></div>',c.shortcut&&o.addEventListener("keydown",y),i(o.querySelector(".supercode-header"),t),((e,o)=>{e.style.width=o+"px",e.style.height="100%",e.style.position="relative",(e=>{if(e.attachShadow({mode:"open"}),c.aceCss){const o=new CSSStyleSheet;o.replaceSync(c.aceCss),e.shadowRoot.adoptedStyleSheets.push(o)}e.shadowRoot.innerHTML='<div class="supercode-editor" style="width: 100%; height: 100%; position: absolute; left:0; top:0"></div>';const o=e.shadowRoot.querySelector(".supercode-editor");o.style.width="100%",o.style.height="100%",r=ace.edit(o),r.renderer.attachToShadowRoot(),l()})(e)})(o.querySelector(".supercode-body "),a)),b()},onHide:()=>{c.shortcut&&removeEventListener("keydown",y)}};o.ui.registry.addView("supercode",e)}return o.ui.registry.addButton("supercode",{icon:c.iconName,tooltip:"Source Code Editor (Ctrl + space)",onAction:h}),o.ui.registry.addMenuItem("supercode",{icon:c.iconName,text:"Source Code",onAction:h}),o.ui.registry.addContextMenu("supercode",{update:e=>"supercode"}),c.shortcut&&o.shortcuts.add("ctrl+32","Toggles Source Code Editing Mode",h),{getMetadata:function(){return{name:"Supercode",url:"https://github.com/prathamVaidya/supercode-tinymce-plugin"}}}}))}();