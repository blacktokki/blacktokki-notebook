"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[430],{9430:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Fe});var r=n(4586),i=n(6330),o=n(9399),a=n(1999),u=n(689),l=n(3705),s=n(9367),c=n(7904),d=n(8077),f=n(8111),p=n(8594);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h,v=(0,p.axiosCreate)("feedynote"),j=function(){var e=(0,i.default)((function*(e){return(yield v.get(`/api/v1/content/${e}`)).data}));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=(0,i.default)((function*(e,t){var n=void 0!==e?`&parentId=${e}`:"",r=void 0!==t?`&type=${t}`:"";return(yield v.get(`/api/v1/content?self=true&size=256${n}${r}`)).data.value}));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=(0,i.default)((function*(e,t,n){var r="TIMELINE"===t?`&grandParentId=${e}`:`&parentId=${e}`,i="LIBRARY"===t?"256":"20";return{current:(yield v.get(`/api/v1/content?self=true&sort=id,DESC&size=${i}&page=${n}${r}`)).data.value}}));return function(t,n,r){return e.apply(this,arguments)}}(),b=function(){var e=(0,i.default)((function*(e){return(yield v.post("/api/v1/content",e)).data.id}));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=(0,i.default)((function*(e){var t=e.id,n=e.updated;yield v.patch("/api/v1/content",{ids:[t],updated:n})}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,i.default)((function*(e){yield v.delete(`/api/v1/content/${e}`)}));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=(0,i.default)((function*(){yield v.get("/api/v1/feed/pull")}));return function(){return e.apply(this,arguments)}}(),C=function(){var e=(0,i.default)((function*(e){return g({type:"SCRAP"},(yield v.get(`/api/v1/preview/autocomplete?query=${e.query}`)).data)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=(0,i.default)((function*(e){return g({type:"FEED"},(yield v.get(`/api/v1/feed/autocomplete?query=${e.query}`)).data)}));return function(t){return e.apply(this,arguments)}}();function E(e,t){return(0,f.useQuery)(["ContentList",e,t],(0,i.default)((function*(){return void 0!==e||void 0!==t?yield x(e,t):void 0}))).data}function D(){var e=(0,f.useQueryClient)(),t=(0,f.useMutation)(b,{onSuccess:function(){e.invalidateQueries("ContentList")}}),n=(0,f.useMutation)(O,{onSuccess:function(){e.invalidateQueries("ContentList"),e.invalidateQueries("Content")}}),r=(0,f.useMutation)(w,{onSuccess:function(){e.invalidateQueries("ContentList")}}),a=(0,f.useMutation)(function(){var t=(0,i.default)((function*(t){console.log("pulling feed: "+t);var n=["ContentList"].concat((0,l.default)(t));return yield e.setQueryData(n,void 0),yield P(),n}));return function(e){return t.apply(this,arguments)}}(),{onSuccess:function(t){e.invalidateQueries(t)}});return(0,o.useEffect)((function(){void 0===h&&(a.mutateAsync([]),h=setInterval((function(){return a.mutateAsync([])}),12e5))}),[]),{create:t.mutateAsync,update:n.mutateAsync,delete:r.mutateAsync,pullFeed:a.mutateAsync}}var I=n(7989),T=n(6927),R=n(3717),L=(n(9850),n(863)),A=n(5888),k=n(2990),B=n(8389),N=n(5073),z=n(575);var F=function(e){var t=e.time,n=(t=void 0===t?{}:t).content,r=t.style,i=e.style;return(0,z.jsx)(c.default,{style:[H.timeContainer,i],children:(0,z.jsx)(d.Text,{style:[H.time,r],children:n})})},$=function(e){var t=e.icon,n=void 0===t?{}:t,r=e.iconStyle,i=e.lineStyle,o="function"===typeof n?(0,z.jsx)(n,{styles:[H.icon,r]}):(0,z.jsx)(N.default,{icon:n.content,style:[H.icon,n.style?n.style:null]});return(0,z.jsxs)(c.default,{style:[H.iconContainer,r],children:[o,(0,z.jsx)(c.default,{style:[H.verticalLine,i]})]})},M=function(e){var t=e.children,n=e.style;return(0,z.jsx)(c.default,{style:[H.eventContainer,n],children:t})},V=function(e){var t=e.event,n=void 0===t?{}:t,r=e.eventStyle,i=e.timeContainerStyle,o=e.iconContainerStyle,a=e.lineStyle,u=e.contentContainerStyle,l=n.title,s=void 0===l?{}:l,f=n.description,p=void 0===f?{}:f,y=n.imageUrl,g=n.time,h=n.icon,v=n.pressAction,j=v?R.default:c.default,x=s&&"function"===typeof s?(0,z.jsx)(s,{styles:H.title}):(0,z.jsx)(d.Text,{style:[H.title,{fontSize:14}],children:s}),m=p&&"function"===typeof p?(0,z.jsx)(p,{styles:H.description}):(0,z.jsxs)(c.default,{style:{flexDirection:"row"},children:[y?(0,z.jsx)(B.default,{source:{uri:y},resizeMode:"cover",style:{width:"33%",maxWidth:150,minHeight:120,borderWidth:1}}):void 0,(0,z.jsx)(d.Text,{style:[H.description,{fontSize:12}],children:p})]});return(0,z.jsxs)(j,{style:[H.row,r],onPress:v,children:[(0,z.jsx)(F,{time:g,style:i}),(0,z.jsx)($,{icon:h,iconStyle:o,lineStyle:a}),(0,z.jsxs)(M,{style:u,children:[x,m]})]})};var H=L.default.create({container:{flex:1,width:"100%"},row:{flexDirection:"row",alignItems:"flex-start",marginVertical:5},timeContainer:{flexBasis:"15%",paddingTop:10},time:{fontSize:12,color:"#888",fontStyle:"italic",textAlign:"center"},iconContainer:{flexBasis:"5%",alignItems:"center",alignSelf:"stretch",marginHorizontal:"5%"},verticalLine:{flex:1,width:1,backgroundColor:"#ccc"},eventContainer:{flexBasis:"65%",flexGrow:1,alignItems:"flex-start",padding:16,borderRadius:15,shadowOffset:{width:A.default.isRTL?8:-8,height:0},shadowColor:"#888",shadowOpacity:.2,marginBottom:10,borderTopLeftRadius:0},icon:{textAlign:"center",width:20,height:20,backgroundColor:"#6F98FA",paddingTop:"ios"===k.default.OS?2.5:5,borderRadius:10,fontSize:9,overflow:"hidden",borderWidth:3,borderColor:"#e0e9ff"},title:{fontSize:12,fontWeight:"bold",textAlign:"left",marginBottom:5,lineHeight:20},description:{textAlign:"left",fontSize:11,lineHeight:18,paddingBottom:10}}),Q=n(3775);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=/<\/?[^>]*>/gi,G=(new Date).getTimezoneOffset(),U=function(e){var t=new Date(e);t.setMinutes(t.getMinutes()-G);var n=t.toISOString().slice(0,16),r=n.slice(0,10);return r==(new Date).toISOString().slice(0,10)?n.slice(11):r},Z=o.memo((function(e){return e.data.map((function(e){return Y(Y({},e),{},{time:{content:U(e.updated)},pressAction:function(){return(0,a.navigate)("EditorScreen",{id:e.id})}})})).map((function(e,t){return(0,z.jsx)(V,{event:e},t)}))})),_=function(e){return e?20:4},J=function(e){return e?230:190},K=o.memo((function(e){var t,n=e.data,r=(0,d.useResizeContext)(),i=J("landscape"===r),o="landscape"===r?2:0;return null==(t=[].concat((0,l.default)(n.sort((function(e,t){return e.updated<t.updated?1:-1}))),[null,null]))?void 0:t.map((function(e,t){var n;if(null===e)return(0,z.jsx)(c.default,{style:{flexBasis:"landscape"===r?"33%":"50%",maxWidth:i}},t);var u=null==(n=e.description)?void 0:n.replaceAll(/\n/g,"").replaceAll(/<hr\s*[\/]?>\n/gi,"").replaceAll(/&nbsp;/gi," ").replaceAll(/<br\s*[\/]?>/gi,"\r\n").replaceAll(q,""),l=function(){return(0,a.navigate)("EditorScreen",{id:e.id})};return(0,z.jsxs)(R.default,{style:{flexBasis:"landscape"===r?"33%":"50%",padding:_("landscape"===r),paddingRight:0,minWidth:i,maxWidth:i},onPress:l,children:[(0,z.jsx)(Q.default,{onPress:l,style:{aspectRatio:1/Math.sqrt(2),borderRadius:6,marginVertical:10,marginHorizontal:8,overflow:"hidden"},children:(0,z.jsx)(Q.default.Content,{children:(0,z.jsx)(d.Text,{style:{fontSize:12+o,opacity:.4},children:u})})}),(0,z.jsxs)(c.default,{style:{flexDirection:"row",marginTop:10,justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,z.jsx)(d.Text,{style:{fontSize:14+o},children:e.title}),(0,z.jsx)(d.Text,{style:{fontSize:12+o,opacity:.4,textAlign:"right"},children:U(e.updated)})]})]},t)}))}));const X=function(e){var t=e.parentContent,n=function(e,t){var n=(0,f.useInfiniteQuery)(["ContentList",e],function(){var n=(0,i.default)((function*(n){var r=n.pageParam;return yield m(e,t,r)}));return function(e){return n.apply(this,arguments)}}(),{select:function(e){return e.pages.length>1&&(e.pages[e.pages.length-2].next=e.pages[e.pages.length-1]),e},getNextPageParam:function(e,t){return t.length},refetchOnReconnect:!1});return{data:n.data,fetchNextPage:n.fetchNextPage}}(t.id,t.type),r=n.data,o=n.fetchNextPage,a=(0,d.useResizeContext)();return r&&("LIBRARY"!==t.type?(0,z.jsx)(T.default,{data:r.pages,renderItem:function(e){var t=e.item;return(0,z.jsx)(Z,{data:t.current})},style:{height:0},onEndReached:function(){o()}}):(0,z.jsx)(s.default,{style:{height:0},contentContainerStyle:{flexDirection:"row",justifyContent:"center"},children:(0,z.jsx)(c.default,{style:{backgroundColor:"transparent",flexBasis:"100%",maxWidth:(J("landscape"===a)+5)*("landscape"===a?5:3),flexWrap:"wrap",flexDirection:"row",paddingRight:_("landscape"===a),justifyContent:"landscape"===a?void 0:"center"},children:r.pages.map((function(e,t){return(0,z.jsx)(K,{data:e.current},t)}))})}))};function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne={},re=function(e){return`<div class="scrap mceNonEditable" style="border:1px solid #ddd; padding:10px; display:flex; align-items:center;">\n  ${void 0!==e.imageUrl?`<img src="${e.imageUrl}" alt="preview" style="width:80px; height:80px; margin-right:10px;">`:""}\n  <div style="word-break:break-word;">\n    <strong>${e.title}</strong><br>\n    <a href="${e.url}" target="_blank">${e.url}</a>\n    ${e.description?`<p>${e.description}</p>`:""}\n  </div>\n</div>`},ie=function(){var e=(0,i.default)((function*(e,t){try{new URL(t)}catch(o){return}if(ne[t])return ne[t];var n="FEED"===e?yield S({query:t}):yield C({query:t});if(n&&null!==n.title){var r=re(te(te({},n),{},{url:t})),i={title:n.title,description:r};return ne[t]=i,i}}));return function(t,n){return e.apply(this,arguments)}}();const oe=function(e,t){var n=(0,o.useState)(),r=(0,u.default)(n,2),a=r[0],l=r[1],s=(0,f.useQuery)(["Preview",e,a],(0,i.default)((function*(){return a?yield ie(e,a):void 0}))).data;return(0,o.useEffect)((function(){var e=setTimeout((function(){return l(t)}),320);return function(){return clearTimeout(e)}}),[t]),s};function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var le=n(2571),se=n(4426);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=o.memo((function(e){var t=oe("SCRAP",e.url);return(null==t?void 0:t.description)&&(0,z.jsxs)(c.default,{style:{height:155,flexDirection:"row"},children:[(0,z.jsx)(se.EditorViewer,{content:t.description}),(0,z.jsx)(d.CommonButton,{title:"\u2728",onPress:function(){return e.replacer(t.description)},style:{height:155,paddingTop:65}})]})})),pe=function(e,t){for(var n,r=t,i=0,o=[];null!=(n=new RegExp(e).exec(r));){o.push({index:i,str:r.substring(0,n.index)});var a=n.index+n[0].length;o.push({index:i+n.index,str:r.substring(n.index,a)}),i+=a,r=r.substring(a)}return o.push({index:i,str:r}),o},ye=function(e,t){if(void 0!==t)return function(e){var t=[],n=/https?:\/\/(?:www\\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&\/=]*)/gi;return pe(/(<a .*?href="(.*?)".*?>(.*)<\/a>|<img .*?src="(.*?)".*?\/>)/,e).forEach((function(e,r){r%2!=1&&pe(n,e.str).forEach((function(n,r){r%2==1&&t.push({pos:e.index+n.index,url:n.str})}))})),t}(t).map((function(n,r){return(0,z.jsx)(fe,{url:n.url,replacer:function(r){e(t.substring(0,n.pos)+r+t.substring(n.pos+n.url.length))}},r)}))};var ge=n(4952),he=n(9767),ve=n(7687),je=n(205),xe=n(5589),me=n(4906);function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var we=function(e){return e?5:8},Pe=function(e){var t=(0,d.useColorScheme)(),n=o.useState(!1),r=(0,u.default)(n,2),i=r[0],l=r[1],s=(0,d.useResizeContext)(),c=E(i?e.timeline.id:void 0),f=we("landscape"===s);return(0,z.jsxs)(d.View,{children:[(0,z.jsx)(ge.default,{title:e.timeline.title,expanded:i&&void 0!==c,style:{padding:f},onPress:function(){return(0,a.navigate)("ContentListScreen",{id:e.timeline.id})},left:function(e){return(0,z.jsx)(N.default,Oe(Oe({},e),{},{icon:i?"chevron-down":"chevron-right"}))},right:function(){},children:c&&c.map((function(e){return(0,z.jsx)(he.default,{left:function(e){return(0,z.jsx)(N.default,Oe(Oe({},e),{},{icon:"rss"}))},title:e.title,onPress:function(){return(0,a.navigate)("ContentListScreen",{id:e.id})},style:{padding:f}},e.id)}))}),(0,z.jsx)(ve.default,{style:{position:"absolute",justifyContent:"center",paddingLeft:8+f,width:40+2*f,height:40+2*f},onPress:function(){return l(!i)},children:(0,z.jsx)((function(e){var n=e.isExpanded;return(0,z.jsx)(me.default,{name:n?"chevron-down":"chevron-right",color:d.Colors[t].text,size:24,direction:A.default.getConstants().isRTL?"rtl":"ltr"})}),{isExpanded:i})})]})};const Ce=function(e){var t=E(0,e.type),n=(0,d.useLangContext)().lang,r=(0,d.useResizeContext)(),i=we("landscape"===r);return(0,z.jsxs)(je.default,{children:[(0,z.jsxs)(d.View,{style:{flexDirection:"row"},children:[(0,z.jsx)(xe.default,{style:{flex:1},selectable:!1,children:n("LIBRARY"===e.type?"Libraries":"Timelines")}),(0,z.jsx)(ve.default,{onPress:function(){return(0,a.navigate)("ContentListScreen",{type:e.type})},children:(0,z.jsx)(N.default,{icon:"plus",style:{margin:i}})})]}),t&&t.map((function(t){return"TIMELINE"==e.type?(0,z.jsx)(Pe,{timeline:t},t.id):(0,z.jsx)(he.default,{left:function(e){return(0,z.jsx)(N.default,Oe(Oe({},e),{},{icon:"library"}))},title:t.title,onPress:function(){return(0,a.navigate)("ContentListScreen",{id:t.id})},style:{padding:i}},t.id)}))]})};var Se=function(){var e=(0,d.useColorScheme)();return(0,z.jsxs)(s.default,{style:{flex:1,backgroundColor:d.Colors[e].background},children:[(0,z.jsx)(Ce,{type:"TIMELINE"}),(0,z.jsx)(Ce,{type:"LIBRARY"})]})},Ee=function(){var e=(0,d.useColorScheme)();return(0,z.jsx)(s.default,{style:{flex:1,backgroundColor:d.Colors[e].background},children:(0,z.jsx)(a.ConfigSections,{})})};var De={HomeScreen:{title:"home",component:function(e){e.navigation,e.route;var t=(0,d.useLangContext)().lang,n=(0,d.useColorScheme)(),r=d.Colors[n].text,i=[{title:t("Contents"),component:Se,icon:(0,z.jsx)(N.default,{icon:"table-of-contents"}),headerRight:function(){return(0,z.jsx)(z.Fragment,{})}},{title:t("Config"),component:Ee,icon:(0,z.jsx)(N.default,{icon:"dots-horizontal"}),headerRight:function(){return(0,z.jsx)(z.Fragment,{})}}];return(0,z.jsx)(a.HomeSection,{tabViews:i,title:t("home"),children:(0,z.jsxs)(c.default,{style:{flexGrow:1,width:"80%",marginTop:72},children:[(0,z.jsx)(d.Text,{style:{fontSize:32,color:r},children:"feedynote"}),(0,z.jsx)(c.default,{style:{backgroundColor:d.Colors.borderColor,height:1,width:"100%"}}),(0,z.jsx)(c.default,{style:{height:24}}),(0,z.jsx)(a.ConfigSections,{})]})})},path:"home"},EditorScreen:{path:"editor",title:"editor",component:function(e){var t,n,r,l,y,g=e.navigation,h=e.route,v={created:void 0===(null==h||null==(t=h.params)?void 0:t.id),id:parseInt(null==h||null==(n=h.params)?void 0:n.id),parentId:void 0!==(null==h||null==(r=h.params)?void 0:r.parentId)?parseInt(null==h||null==(l=h.params)?void 0:l.parentId):0},x=(0,d.useColorScheme)(),m=(0,d.useLangContext)().lang,b=(0,p.useAuthContext)().auth,O=(y=v.created?void 0:v.id,(0,f.useQuery)(["Content",y],(0,i.default)((function*(){return y?yield j(y):void 0}))).data),w=E(null==O?void 0:O.parentId),P=D(),C=(0,o.useState)(),S=(0,u.default)(C,2),T=S[0],R=S[1],L=(0,o.useState)(),A=(0,u.default)(L,2),k=A[0],B=A[1],N=(0,o.useState)(),F=(0,u.default)(N,2),$=F[0],M=F[1],V=(0,o.useState)(!1),H=(0,u.default)(V,2),Q=H[0],W=H[1],Y={NOTE:m("New Note")},q=function(){W(!0)};(0,o.useLayoutEffect)((function(){if(console.log(null==O?void 0:O.id),v.created){var e="NOTE";W(!1),R(Y[e]),B(""),M(e)}else O&&(W(!1),R(O.input),B(O.description),M(O.type))}),[null==O?void 0:O.id]),(0,o.useLayoutEffect)((function(){v.created?g.setOptions({headerShown:!1}):O&&g.setOptions({title:O.title,headerRight:function(){return(0,z.jsx)(c.default,{style:{flexDirection:"row"},children:"FEEDCONTENT"===O.type?(0,z.jsx)(d.CommonButton,{title:"\ud83c\udf10",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return le.default.openURL(O.input)}}):(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(d.CommonButton,{title:"\u270f\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:q}),(0,z.jsx)(d.CommonButton,{title:"\ud83d\uddd1\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return P.delete(O.id).then((function(e){return G()}))}})]})})},headerShown:!Q})}),[g,O,Q]);var G=function(){g.canGoBack()?g.goBack():g.navigate("HomeScreen",{tab:1})},U=v.created||Q;return(0,z.jsxs)(d.View,{style:{width:"100%",height:"100%"},children:[U&&void 0!==T&&(0,z.jsx)(I.default,{mode:"outlined",value:T,onChangeText:R,style:{borderRadius:20,margin:1}}),"NOTE"===$&&(0,z.jsx)(se.Editor,{theme:x,active:U,value:k||"",setValue:U?B:function(){}}),U&&(0,z.jsxs)(z.Fragment,{children:[ye(B,k),(0,z.jsx)(d.CommonButton,{title:m("save"),onPress:function(){var e,t;!b.user||(null==O?void 0:O.input)==T&&(null==O?void 0:O.description)==k||void 0===$?W(!1):(v.created?t=P.create({userId:b.user.id,parentId:v.parentId,type:$,order:((null==w?void 0:w.length)||0)+1,input:T||"",title:T||"",description:k}).then((function(e){(0,a.navigate)("EditorScreen",{id:e})})):void 0!==O&&(t=P.update({id:O.id,updated:de(de({},O),{},{type:$,input:T||"",title:T||"",description:k})})),null==(e=t)||e.then((function(){W(!1)})))},style:{height:65,paddingVertical:20}})]}),(0,z.jsx)(s.default,{style:{flex:U?0:1},contentContainerStyle:{flexGrow:1},children:(0,z.jsx)(se.EditorViewer,{content:"FEEDCONTENT"===(null==O?void 0:O.type)?re(de(de({},O),{},{url:O.input})):k||"",onPress:"FEEDCONTENT"===(null==O?void 0:O.type)?void 0:q})})]})}},ContentListScreen:{path:"contents",title:"contents",component:function(e){var t,n,r,i,f=e.navigation,y=e.route,g={created:void 0===(null==y||null==(t=y.params)?void 0:t.id),id:parseInt(null==y||null==(n=y.params)?void 0:n.id),parentId:null!=y&&null!=(r=y.params)&&r.parentId?parseInt(y.params.parentId):void 0,type:null==y||null==(i=y.params)?void 0:i.type},h=(0,d.useLangContext)().lang,v=(0,p.useAuthContext)().auth,j=E(0),x=E(void 0,"FEED"),m=void 0!==j&&void 0!==x?[].concat((0,l.default)(j),(0,l.default)(x)):void 0,b=D(),O=g.created||null==m?void 0:m.find((function(e){return e.id===g.id})),w=(0,o.useState)(),P=(0,u.default)(w,2),C=P[0],S=P[1],T=(0,o.useState)(),R=(0,u.default)(T,2),L=R[0],A=R[1],k=(0,o.useState)(!1),B=(0,u.default)(k,2),N=B[0],F=B[1],$=oe("FEED",g.created&&"FEED"===g.type?C:void 0),M=function(){f.canGoBack()?f.goBack():f.navigate("HomeScreen",{tab:1})};g.created&&"FEED"===g.type&&void 0===g.parentId&&M();var V={LIBRARY:h("New Library"),TIMELINE:h("New Timelines"),FEED:"https://"},H=function(){F(!0)};(0,o.useLayoutEffect)((function(){g.created?(F(!1),S(V[g.type]),A(g.type)):O&&(F(!1),S(O.input),A(O.type))}),[O]),(0,o.useLayoutEffect)((function(){g.created?f.setOptions({headerShown:!1}):O&&f.setOptions({title:O.title,headerRight:function(){return(0,z.jsxs)(c.default,{style:{flexDirection:"row"},children:["LIBRARY"===O.type&&(0,z.jsx)(d.CommonButton,{title:"\u2295",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return(0,a.navigate)("EditorScreen",{parentId:O.id})}}),"TIMELINE"===O.type&&(0,z.jsx)(d.CommonButton,{title:"\u2295",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return(0,a.navigate)("ContentListScreen",{type:"FEED",parentId:O.id})}}),"LIBRARY"!==O.type&&(0,z.jsx)(d.CommonButton,{title:"\ud83d\udd04",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return b.pullFeed("TIMELINE"===O.type?[void 0,"FEEDCONTENT"]:[O.id,void 0])}}),(0,z.jsx)(d.CommonButton,{title:"\u270f\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:H}),(0,z.jsx)(d.CommonButton,{title:"\ud83d\uddd1\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return b.delete(O.id).then((function(e){return M()}))}})]})},headerShown:!N})}),[f,O,N]);var Q=g.created||N;return(0,z.jsx)(d.View,{style:{width:"100%",height:"100%",backgroundColor:"transparent"},children:Q?(0,z.jsxs)(z.Fragment,{children:[void 0!==C&&(0,z.jsx)(I.default,{mode:"outlined",value:C,onChangeText:S,style:{borderRadius:20,margin:1}}),(null==$?void 0:$.description)&&(0,z.jsx)(d.Text,{children:$.description}),("FEED"!==L||void 0!==$)&&(0,z.jsx)(d.CommonButton,{title:h("save"),onPress:function(){var e;if(v.user&&(null==O?void 0:O.input)!=C&&void 0!==L){var t,n=null!=$&&$.title?$.title:C||"";if(g.created){var r=null==m?void 0:m.filter((function(e){return e.type==g.type}));t=b.create({userId:v.user.id,parentId:"FEED"===g.type?g.parentId:0,type:L,order:((null==r?void 0:r.length)||0)+1,input:C||"",title:n}).then((function(e){(0,a.navigate)("ContentListScreen",{id:e})}))}else void 0!==O&&(t=b.update({id:O.id,updated:ue(ue({},O),{},{type:L,input:C||"",title:n})}));null==(e=t)||e.then((function(){F(!1)}))}else F(!1)},style:{height:65,paddingVertical:20}}),(0,z.jsx)(d.CommonButton,{title:h("cancel"),onPress:g.created?M:function(){return F(!1)},style:{height:65,paddingVertical:20}})]}):(0,z.jsx)(s.default,{style:{flex:1},contentContainerStyle:{flexGrow:1},children:O&&(0,z.jsx)(X,{parentContent:O})})})}}};function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Re=function(){var e=(0,d.useLangContext)().lang;return(0,z.jsxs)(s.default,{style:{flex:1},children:[(0,z.jsx)(he.default,{left:function(e){return(0,z.jsx)(N.default,Te(Te({},e),{},{icon:"home"}))},title:e("Home"),onPress:function(){return(0,a.navigate)("HomeScreen")}}),(0,z.jsx)(Ce,{type:"TIMELINE"}),(0,z.jsx)(Ce,{type:"LIBRARY"})]})};var Le=n(8610),Ae=n(7650),ke=n(2876);function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ze=function(){var e=(0,i.default)((function*(){var e=yield Promise.all([n.e(928),n.e(973)]).then(n.bind(n,9928));return{main:De,login:a.login,prefixes:[e.makeUrl("/")],rootPath:"feedynote",documentTitle:{formatter:function(){return"feedynote"}},rootScreen:{main:"HomeScreen",login:"LoginScreen"},headerLeftIcon:(0,z.jsx)(N.default,{icon:"backburger",style:{left:-18,top:-14}}),headerRight:(0,z.jsx)(z.Fragment,{}),modals:[],drawer:(0,z.jsx)(Re,{})}}));return function(){return e.apply(this,arguments)}}();const Fe=function(){var e=(0,d.useColorScheme)(),t="dark"==e?Le.MD2DarkTheme:Ae.MD2LightTheme,n=Ne(Ne({},t),{},{colors:Ne(Ne({},t.colors),{},{primary:d.Colors[e].text})}),r=o.lazy((function(){return ze().then((function(e){return{default:function(){return(0,z.jsx)(a.Navigation,{config:e})}}}))}));return(0,z.jsx)(ke.default,{theme:n,children:(0,z.jsx)(o.Suspense,{fallback:(0,z.jsx)(z.Fragment,{}),children:(0,z.jsx)(r,{})})})}}}]);
//# sourceMappingURL=430.3cf39d1b.chunk.js.map