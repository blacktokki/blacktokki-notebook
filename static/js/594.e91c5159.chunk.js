(self.webpackChunkweb=self.webpackChunkweb||[]).push([[594],{9430:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ze});var r=n(4586),i=n(9399),o=n(9928),a=n(1632),l=n(689),u=n(3705),s=n(9367),c=n(7904),d=n(8077),f=n(6330),p=n(8111),g=n(7628);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v,x=function(){var e=(0,f.default)((function*(e){return(yield g.default.get(`/api/v1/content/${e}`)).data}));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=(0,f.default)((function*(e,t){var n=void 0!==e?`&parentId=${e}`:"",r=void 0!==t?`&type=${t}`:"";return(yield g.default.get(`/api/v1/content?self=true&size=256${n}${r}`)).data.value}));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=(0,f.default)((function*(e,t,n){var r="TIMELINE"===t?`&grandParentId=${e}`:`&parentId=${e}`,i="LIBRARY"===t?"256":"20";return{current:(yield g.default.get(`/api/v1/content?self=true&sort=id,DESC&size=${i}&page=${n}${r}`)).data.value}}));return function(t,n,r){return e.apply(this,arguments)}}(),b=function(){var e=(0,f.default)((function*(e){return(yield g.default.post("/api/v1/content",e)).data.id}));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=(0,f.default)((function*(e){var t=e.id,n=e.updated;yield g.default.patch("/api/v1/content",{ids:[t],updated:n})}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,f.default)((function*(e){yield g.default.delete(`/api/v1/content/${e}`)}));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,f.default)((function*(){yield g.default.get("/api/v1/feed/pull")}));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,f.default)((function*(e){return h({type:"SCRAP"},(yield g.default.get(`/api/v1/preview/autocomplete?query=${e.query}`)).data)}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=(0,f.default)((function*(e){return h({type:"FEED"},(yield g.default.get(`/api/v1/feed/autocomplete?query=${e.query}`)).data)}));return function(t){return e.apply(this,arguments)}}();function E(e,t){return(0,p.useQuery)(["ContentList",e,t],(0,f.default)((function*(){return void 0!==e||void 0!==t?yield j(e,t):void 0}))).data}function D(){var e=(0,p.useQueryClient)(),t=(0,p.useMutation)(b,{onSuccess:function(){e.invalidateQueries("ContentList")}}),n=(0,p.useMutation)(O,{onSuccess:function(){e.invalidateQueries("ContentList"),e.invalidateQueries("Content")}}),r=(0,p.useMutation)(w,{onSuccess:function(){e.invalidateQueries("ContentList")}}),o=(0,p.useMutation)(function(){var t=(0,f.default)((function*(t){console.log("pulling feed: "+t);var n=["ContentList"].concat((0,u.default)(t));return yield e.setQueryData(n,void 0),yield C(),n}));return function(e){return t.apply(this,arguments)}}(),{onSuccess:function(t){e.invalidateQueries(t)}});return(0,i.useEffect)((function(){void 0===v&&(o.mutateAsync([]),v=setInterval((function(){return o.mutateAsync([])}),12e5))}),[]),{create:t.mutateAsync,update:n.mutateAsync,delete:r.mutateAsync,pullFeed:o.mutateAsync}}var I=n(7989),T=n(4537),R=n(6927),L=n(3717),k=(n(9850),n(863)),A=n(5888),B=n(2990),N=n(8389),z=n(5073),F=n(575);var $=function(e){var t=e.time,n=(t=void 0===t?{}:t).content,r=t.style,i=e.style;return(0,F.jsx)(c.default,{style:[Q.timeContainer,i],children:(0,F.jsx)(d.Text,{style:[Q.time,r],children:n})})},M=function(e){var t=e.icon,n=void 0===t?{}:t,r=e.iconStyle,i=e.lineStyle,o="function"===typeof n?(0,F.jsx)(n,{styles:[Q.icon,r]}):(0,F.jsx)(z.default,{icon:n.content,style:[Q.icon,n.style?n.style:null]});return(0,F.jsxs)(c.default,{style:[Q.iconContainer,r],children:[o,(0,F.jsx)(c.default,{style:[Q.verticalLine,i]})]})},H=function(e){var t=e.children,n=e.style;return(0,F.jsx)(c.default,{style:[Q.eventContainer,n],children:t})},V=function(e){var t=e.event,n=void 0===t?{}:t,r=e.eventStyle,i=e.timeContainerStyle,o=e.iconContainerStyle,a=e.lineStyle,l=e.contentContainerStyle,u=n.title,s=void 0===u?{}:u,f=n.description,p=void 0===f?{}:f,g=n.imageUrl,y=n.time,h=n.icon,v=n.pressAction,x=v?L.default:c.default,j=s&&"function"===typeof s?(0,F.jsx)(s,{styles:Q.title}):(0,F.jsx)(d.Text,{style:[Q.title,{fontSize:14}],children:s}),m=p&&"function"===typeof p?(0,F.jsx)(p,{styles:Q.description}):(0,F.jsxs)(c.default,{style:{flexDirection:"row"},children:[g?(0,F.jsx)(N.default,{source:{uri:g},resizeMode:"cover",style:{width:"33%",maxWidth:150,minHeight:120,borderWidth:1}}):void 0,(0,F.jsx)(d.Text,{style:[Q.description,{fontSize:12}],children:p})]});return(0,F.jsxs)(x,{style:[Q.row,r],onPress:v,children:[(0,F.jsx)($,{time:y,style:i}),(0,F.jsx)(M,{icon:h,iconStyle:o,lineStyle:a}),(0,F.jsxs)(H,{style:l,children:[j,m]})]})};var Q=k.default.create({container:{flex:1,width:"100%"},row:{flexDirection:"row",alignItems:"flex-start",marginVertical:5},timeContainer:{flexBasis:"15%",paddingTop:10},time:{fontSize:12,color:"#888",fontStyle:"italic",textAlign:"center"},iconContainer:{flexBasis:"5%",alignItems:"center",alignSelf:"stretch",marginHorizontal:"5%"},verticalLine:{flex:1,width:1,backgroundColor:"#ccc"},eventContainer:{flexBasis:"65%",flexGrow:1,alignItems:"flex-start",padding:16,borderRadius:15,shadowOffset:{width:A.default.isRTL?8:-8,height:0},shadowColor:"#888",shadowOpacity:.2,marginBottom:10,borderTopLeftRadius:0},icon:{textAlign:"center",width:20,height:20,backgroundColor:"#6F98FA",paddingTop:"ios"===B.default.OS?2.5:5,borderRadius:10,fontSize:9,overflow:"hidden",borderWidth:3,borderColor:"#e0e9ff"},title:{fontSize:12,fontWeight:"bold",textAlign:"left",marginBottom:5,lineHeight:20},description:{textAlign:"left",fontSize:11,lineHeight:18,paddingBottom:10}}),W=n(3775);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=/<\/?[^>]*>/gi,U=(new Date).getTimezoneOffset(),Z=function(e){var t=new Date(e);t.setMinutes(t.getMinutes()-U);var n=t.toISOString().slice(0,16),r=n.slice(0,10);return r==(new Date).toISOString().slice(0,10)?n.slice(11):r},_=i.memo((function(e){return e.data.map((function(e){return q(q({},e),{},{time:{content:Z(e.updated)},pressAction:function(){return(0,a.navigate)("EditorScreen",{id:e.id})}})})).map((function(e,t){return(0,F.jsx)(V,{event:e},t)}))})),J=function(e){return e?20:0},K=i.memo((function(e){var t,n=e.data,r=(0,d.useResizeContext)(),i="landscape"===r?230:205;return null==(t=(0,u.default)(n))?void 0:t.map((function(e,t){var n;if(null===e)return(0,F.jsx)(d.View,{style:{flexBasis:"landscape"===r?"33%":"50%",maxWidth:i}},t);var o=null==(n=e.description)?void 0:n.replaceAll(/\n/g,"").replaceAll(/<hr\s*[\/]?>\n/gi,"").replaceAll(/&nbsp;/gi," ").replaceAll(/<br\s*[\/]?>/gi,"\r\n").replaceAll(G,""),l=function(){return(0,a.navigate)("EditorScreen",{id:e.id})};return(0,F.jsxs)(L.default,{style:{flexBasis:"landscape"===r?"33%":"50%",padding:J("landscape"===r),paddingRight:0,minWidth:i,maxWidth:i},onPress:l,children:[(0,F.jsx)(W.default,{onPress:l,style:{aspectRatio:1/Math.sqrt(2),borderRadius:6,marginVertical:10,marginHorizontal:8,overflow:"hidden"},children:(0,F.jsx)(W.default.Content,{children:(0,F.jsx)(d.Text,{style:{fontSize:16,opacity:.4},children:o})})}),(0,F.jsxs)(c.default,{style:{flexDirection:"row",marginTop:10,justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,F.jsx)(d.Text,{style:{fontSize:18},children:e.title}),(0,F.jsx)(d.Text,{style:{fontSize:14,opacity:.4,textAlign:"right"},children:Z(e.updated)})]})]},t)}))}));const X=function(e){var t=e.parentContent,n=function(e,t){var n=(0,p.useInfiniteQuery)(["ContentList",e],function(){var n=(0,f.default)((function*(n){var r=n.pageParam;return yield m(e,t,r)}));return function(e){return n.apply(this,arguments)}}(),{select:function(e){return e.pages.length>1&&(e.pages[e.pages.length-2].next=e.pages[e.pages.length-1]),e},getNextPageParam:function(e,t){return t.length},refetchOnReconnect:!1});return{data:n.data,fetchNextPage:n.fetchNextPage}}(t.id,t.type),r=n.data,i=n.fetchNextPage,o=(0,d.useResizeContext)();(0,d.useColorScheme)();return r&&("LIBRARY"!==t.type?(0,F.jsx)(R.default,{data:r.pages,renderItem:function(e){var t=e.item;return(0,F.jsx)(_,{data:t.current})},style:{height:0},onEndReached:function(){i()}}):(0,F.jsxs)(s.default,{style:{height:0},contentContainerStyle:{flexDirection:"row",justifyContent:"center"},children:[(0,F.jsx)(c.default,{style:{backgroundColor:"transparent",flexBasis:"100%",maxWidth:1280,flexWrap:"wrap",flexDirection:"row",paddingRight:J("landscape"===o)},children:r.pages.map((function(e,t){return(0,F.jsx)(K,{data:e.current},t)}))}),"landscape"===o&&(0,F.jsx)(c.default,{style:{backgroundColor:"transparent",flexBasis:"0%",flexGrow:1,maxWidth:240}})]}))};function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne={},re=function(e){return`<div class="scrap mceNonEditable" style="border:1px solid #ddd; padding:10px; display:flex; align-items:center;">\n  ${void 0!==e.imageUrl?`<img src="${e.imageUrl}" alt="preview" style="width:80px; height:80px; margin-right:10px;">`:""}\n  <div style="word-break:break-word;">\n    <strong>${e.title}</strong><br>\n    <a href="${e.url}" target="_blank">${e.url}</a>\n    ${e.description?`<p>${e.description}</p>`:""}\n  </div>\n</div>`},ie=function(){var e=(0,f.default)((function*(e,t){try{new URL(t)}catch(o){return}if(ne[t])return ne[t];var n="FEED"===e?yield S({query:t}):yield P({query:t});if(n&&null!==n.title){var r=re(te(te({},n),{},{url:t})),i={title:n.title,description:r};return ne[t]=i,i}}));return function(t,n){return e.apply(this,arguments)}}();const oe=function(e,t){var n=(0,i.useState)(),r=(0,l.default)(n,2),o=r[0],a=r[1],u=(0,p.useQuery)(["Preview",e,o],(0,f.default)((function*(){return o?yield ie(e,o):void 0}))).data;return(0,i.useEffect)((function(){var e=setTimeout((function(){return a(t)}),320);return function(){return clearTimeout(e)}}),[t]),u};function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=n(2571),se=n(5614);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=i.memo((function(e){var t=oe("SCRAP",e.url);return(null==t?void 0:t.description)&&(0,F.jsxs)(c.default,{style:{height:155,flexDirection:"row"},children:[(0,F.jsx)(se.EditorHtml,{content:t.description}),(0,F.jsx)(d.CommonButton,{title:"\u2728",onPress:function(){return e.replacer(t.description)},style:{height:155,paddingTop:65}})]})})),pe=function(e,t){for(var n,r=t,i=0,o=[];null!=(n=new RegExp(e).exec(r));){o.push({index:i,str:r.substring(0,n.index)});var a=n.index+n[0].length;o.push({index:i+n.index,str:r.substring(n.index,a)}),i+=a,r=r.substring(a)}return o.push({index:i,str:r}),o},ge=function(e,t){if(void 0!==t)return function(e){var t=[],n=/https?:\/\/(?:www\\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&\/=]*)/gi;return pe(/(<a .*?href="(.*?)".*?>(.*)<\/a>|<img .*?src="(.*?)".*?\/>)/,e).forEach((function(e,r){r%2!=1&&pe(n,e.str).forEach((function(n,r){r%2==1&&t.push({pos:e.index+n.index,url:n.str})}))})),t}(t).map((function(n,r){return(0,F.jsx)(fe,{url:n.url,replacer:function(r){e(t.substring(0,n.pos)+r+t.substring(n.pos+n.url.length))}},r)}))};var ye=n(4952),he=n(9767),ve=n(7687),xe=n(205),je=n(5589),me=n(4906);function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var we=function(e){return e?5:8},Ce=function(e){var t=(0,d.useColorScheme)(),n=i.useState(!1),r=(0,l.default)(n,2),o=r[0],u=r[1],s=(0,d.useResizeContext)(),c=E(o?e.timeline.id:void 0),f=we("landscape"===s);return(0,F.jsxs)(d.View,{children:[(0,F.jsx)(ye.default,{title:e.timeline.title,expanded:o&&void 0!==c,style:{padding:f},onPress:function(){return(0,a.navigate)("ContentListScreen",{id:e.timeline.id})},left:function(e){return(0,F.jsx)(z.default,Oe(Oe({},e),{},{icon:o?"chevron-down":"chevron-right"}))},right:function(){},children:c&&c.map((function(e){return(0,F.jsx)(he.default,{left:function(e){return(0,F.jsx)(z.default,Oe(Oe({},e),{},{icon:"rss"}))},title:e.title,onPress:function(){return(0,a.navigate)("ContentListScreen",{id:e.id})},style:{padding:f}},e.id)}))}),(0,F.jsx)(ve.default,{style:{position:"absolute",justifyContent:"center",paddingLeft:8+f,width:40+2*f,height:40+2*f},onPress:function(){return u(!o)},children:(0,F.jsx)((function(e){var n=e.isExpanded;return(0,F.jsx)(me.default,{name:n?"chevron-down":"chevron-right",color:d.Colors[t].text,size:24,direction:A.default.getConstants().isRTL?"rtl":"ltr"})}),{isExpanded:o})})]})};const Pe=function(e){var t=E(0,e.type),n=(0,d.useLangContext)().lang,r=(0,d.useResizeContext)(),i=we("landscape"===r);return(0,F.jsxs)(xe.default,{children:[(0,F.jsxs)(d.View,{style:{flexDirection:"row"},children:[(0,F.jsx)(je.default,{style:{flex:1},selectable:!1,children:n("LIBRARY"===e.type?"Libraries":"Timelines")}),(0,F.jsx)(ve.default,{onPress:function(){return(0,a.navigate)("ContentListScreen",{type:e.type})},children:(0,F.jsx)(z.default,{icon:"plus",style:{margin:i}})})]}),t&&t.map((function(t){return"TIMELINE"==e.type?(0,F.jsx)(Ce,{timeline:t},t.id):(0,F.jsx)(he.default,{left:function(e){return(0,F.jsx)(z.default,Oe(Oe({},e),{},{icon:"library"}))},title:t.title,onPress:function(){return(0,a.navigate)("ContentListScreen",{id:t.id})},style:{padding:i}},t.id)}))]})};var Se=function(){var e=(0,d.useColorScheme)();return(0,F.jsxs)(s.default,{style:{flex:1,backgroundColor:d.Colors[e].background},children:[(0,F.jsx)(Pe,{type:"TIMELINE"}),(0,F.jsx)(Pe,{type:"LIBRARY"})]})},Ee=function(){var e=(0,d.useColorScheme)();return(0,F.jsx)(s.default,{style:{flex:1,backgroundColor:d.Colors[e].background},children:(0,F.jsx)(a.ConfigSections,{})})};var De={HomeScreen:{title:"home",component:function(e){e.navigation,e.route;var t=(0,d.useLangContext)().lang,n=(0,d.useColorScheme)(),r=d.Colors[n].text,i=[{title:t("Contents"),component:Se,icon:(0,F.jsx)(z.default,{icon:"table-of-contents"}),headerRight:function(){return(0,F.jsx)(F.Fragment,{})}},{title:t("Config"),component:Ee,icon:(0,F.jsx)(z.default,{icon:"dots-horizontal"}),headerRight:function(){return(0,F.jsx)(F.Fragment,{})}}];return(0,F.jsx)(a.HomeSection,{tabViews:i,title:t("home"),children:(0,F.jsxs)(c.default,{style:{flexGrow:1,width:"80%",marginTop:72},children:[(0,F.jsx)(d.Text,{style:{fontSize:32,color:r},children:"feedynote"}),(0,F.jsx)(c.default,{style:{backgroundColor:d.Colors.borderColor,height:1,width:"100%"}}),(0,F.jsx)(c.default,{style:{height:24}}),(0,F.jsx)(a.ConfigSections,{})]})})},path:"home"},EditorScreen:{path:"editor",title:"editor",component:function(e){var t,n,r,o,u,g=e.navigation,y=e.route,h={created:void 0===(null==y||null==(t=y.params)?void 0:t.id),id:parseInt(null==y||null==(n=y.params)?void 0:n.id),parentId:void 0!==(null==y||null==(r=y.params)?void 0:r.parentId)?parseInt(null==y||null==(o=y.params)?void 0:o.parentId):0},v=(0,d.useColorScheme)(),j=(0,d.useLangContext)().lang,m=(0,T.useAuthContext)().auth,b=(u=h.created?void 0:h.id,(0,p.useQuery)(["Content",u],(0,f.default)((function*(){return u?yield x(u):void 0}))).data),O=E(null==b?void 0:b.parentId),w=D(),C=(0,i.useState)(),P=(0,l.default)(C,2),S=P[0],R=P[1],L=(0,i.useState)(),k=(0,l.default)(L,2),A=k[0],B=k[1],N=(0,i.useState)(),z=(0,l.default)(N,2),$=z[0],M=z[1],H=(0,i.useState)(!1),V=(0,l.default)(H,2),Q=V[0],W=V[1],Y={NOTE:j("New Note")},q=function(){W(!0)};(0,i.useLayoutEffect)((function(){if(console.log(null==b?void 0:b.id),h.created){var e="NOTE";W(!1),R(Y[e]),B(""),M(e)}else b&&(W(!1),R(b.input),B(b.description),M(b.type))}),[null==b?void 0:b.id]),(0,i.useLayoutEffect)((function(){h.created?g.setOptions({headerShown:!1}):b&&g.setOptions({title:b.title,headerRight:function(){return(0,F.jsx)(c.default,{style:{flexDirection:"row"},children:"FEEDCONTENT"===b.type?(0,F.jsx)(d.CommonButton,{title:"\ud83c\udf10",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return ue.default.openURL(b.input)}}):(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(d.CommonButton,{title:"\u270f\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:q}),(0,F.jsx)(d.CommonButton,{title:"\ud83d\uddd1\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return w.delete(b.id).then((function(e){return G()}))}})]})})},headerShown:!Q})}),[g,b,Q]);var G=function(){g.canGoBack()?g.goBack():g.navigate("HomeScreen",{tab:1})},U=h.created||Q;return(0,F.jsxs)(d.View,{style:{width:"100%",height:"100%"},children:[U&&void 0!==S&&(0,F.jsx)(I.default,{mode:"outlined",value:S,onChangeText:R,style:{borderRadius:20,margin:1}}),"NOTE"===$&&(0,F.jsx)(se.Editor,{theme:v,active:U,value:A||"",setValue:U?B:function(){}}),U&&(0,F.jsxs)(F.Fragment,{children:[ge(B,A),(0,F.jsx)(d.CommonButton,{title:j("save"),onPress:function(){var e,t;!m.user||(null==b?void 0:b.input)==S&&(null==b?void 0:b.description)==A||void 0===$?W(!1):(h.created?t=w.create({userId:m.user.id,parentId:h.parentId,type:$,order:((null==O?void 0:O.length)||0)+1,input:S||"",title:S||"",description:A}).then((function(e){(0,a.navigate)("EditorScreen",{id:e})})):void 0!==b&&(t=w.update({id:b.id,updated:de(de({},b),{},{type:$,input:S||"",title:S||"",description:A})})),null==(e=t)||e.then((function(){W(!1)})))},style:{height:65,paddingVertical:20}})]}),(0,F.jsx)(s.default,{style:{flex:U?0:1},contentContainerStyle:{flexGrow:1},children:(0,F.jsx)(se.EditorHtml,{content:"FEEDCONTENT"===(null==b?void 0:b.type)?re(de(de({},b),{},{url:b.input})):A||"",onPress:"FEEDCONTENT"===(null==b?void 0:b.type)?void 0:q})})]})}},ContentListScreen:{path:"contents",title:"contents",component:function(e){var t,n,r,o,f=e.navigation,p=e.route,g={created:void 0===(null==p||null==(t=p.params)?void 0:t.id),id:parseInt(null==p||null==(n=p.params)?void 0:n.id),parentId:null!=p&&null!=(r=p.params)&&r.parentId?parseInt(p.params.parentId):void 0,type:null==p||null==(o=p.params)?void 0:o.type},y=(0,d.useLangContext)().lang,h=(0,T.useAuthContext)().auth,v=E(0),x=E(void 0,"FEED"),j=void 0!==v&&void 0!==x?[].concat((0,u.default)(v),(0,u.default)(x)):void 0,m=D(),b=g.created||null==j?void 0:j.find((function(e){return e.id===g.id})),O=(0,i.useState)(),w=(0,l.default)(O,2),C=w[0],P=w[1],S=(0,i.useState)(),R=(0,l.default)(S,2),L=R[0],k=R[1],A=(0,i.useState)(!1),B=(0,l.default)(A,2),N=B[0],z=B[1],$=oe("FEED",g.created&&"FEED"===g.type?C:void 0),M=function(){f.canGoBack()?f.goBack():f.navigate("HomeScreen",{tab:1})};g.created&&"FEED"===g.type&&void 0===g.parentId&&M();var H={LIBRARY:y("New Library"),TIMELINE:y("New Timelines"),FEED:"https://"},V=function(){z(!0)};(0,i.useLayoutEffect)((function(){g.created?(z(!1),P(H[g.type]),k(g.type)):b&&(z(!1),P(b.input),k(L))}),[b]),(0,i.useLayoutEffect)((function(){g.created?f.setOptions({headerShown:!1}):b&&f.setOptions({title:b.title,headerRight:function(){return(0,F.jsxs)(c.default,{style:{flexDirection:"row"},children:["LIBRARY"===b.type&&(0,F.jsx)(d.CommonButton,{title:"\u2295",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return(0,a.navigate)("EditorScreen",{parentId:b.id})}}),"TIMELINE"===b.type&&(0,F.jsx)(d.CommonButton,{title:"\u2295",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return(0,a.navigate)("ContentListScreen",{type:"FEED",parentId:b.id})}}),"LIBRARY"!==b.type&&(0,F.jsx)(d.CommonButton,{title:"\ud83d\udd04",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return m.pullFeed("TIMELINE"===b.type?[void 0,"FEEDCONTENT"]:[b.id,void 0])}}),(0,F.jsx)(d.CommonButton,{title:"\u270f\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:V}),(0,F.jsx)(d.CommonButton,{title:"\ud83d\uddd1\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return m.delete(b.id).then((function(e){return M()}))}})]})},headerShown:!N})}),[f,b,N]);var Q=g.created||N;return(0,F.jsx)(d.View,{style:{width:"100%",height:"100%",backgroundColor:"transparent"},children:Q?(0,F.jsxs)(F.Fragment,{children:[void 0!==C&&(0,F.jsx)(I.default,{mode:"outlined",value:C,onChangeText:P,style:{borderRadius:20,margin:1}}),(null==$?void 0:$.description)&&(0,F.jsx)(d.Text,{children:$.description}),("FEED"!==L||void 0!==$)&&(0,F.jsx)(d.CommonButton,{title:y("save"),onPress:function(){var e;if(h.user&&(null==b?void 0:b.input)!=C&&void 0!==L){var t,n=null!=$&&$.title?$.title:C||"";if(g.created){var r=null==j?void 0:j.filter((function(e){return e.type==g.type}));t=m.create({userId:h.user.id,parentId:"FEED"===g.type?g.parentId:0,type:L,order:((null==r?void 0:r.length)||0)+1,input:C||"",title:n}).then((function(e){(0,a.navigate)("ContentListScreen",{id:e})}))}else void 0!==b&&(t=m.update({id:b.id,updated:le(le({},b),{},{type:L,input:C||"",title:n})}));null==(e=t)||e.then((function(){z(!1)}))}else z(!1)},style:{height:65,paddingVertical:20}}),(0,F.jsx)(d.CommonButton,{title:y("cancel"),onPress:g.created?M:function(){return z(!1)},style:{height:65,paddingVertical:20}})]}):(0,F.jsx)(s.default,{style:{flex:1},contentContainerStyle:{flexGrow:1},children:b&&(0,F.jsx)(X,{parentContent:b})})})}}};function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=n(8610),Le=n(7650),ke=n(8565);function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne={main:De,login:a.login,prefixes:[o.makeUrl("/")],rootPath:"feedynote",documentTitle:{formatter:function(){return"feedynote"}},rootScreen:{main:"HomeScreen",login:"LoginScreen"},headerLeftIcon:(0,F.jsx)(z.default,{icon:"backburger",style:{left:-18,top:-14}}),headerRight:(0,F.jsx)(F.Fragment,{}),modals:[],drawer:(0,F.jsx)((function(){var e=(0,d.useLangContext)().lang;return(0,F.jsxs)(s.default,{style:{flex:1},children:[(0,F.jsx)(he.default,{left:function(e){return(0,F.jsx)(z.default,Te(Te({},e),{},{icon:"home"}))},title:e("Home"),onPress:function(){return(0,a.navigate)("HomeScreen")}}),(0,F.jsx)(Pe,{type:"TIMELINE"}),(0,F.jsx)(Pe,{type:"LIBRARY"})]})}),{})};const ze=function(){var e=(0,d.useColorScheme)(),t="dark"==e?Re.MD2DarkTheme:Le.MD2LightTheme,n=Be(Be({},t),{},{colors:Be(Be({},t.colors),{},{primary:d.Colors[e].text})});return(0,F.jsx)(ke.default,{theme:n,children:(0,F.jsx)(a.Navigation,{config:Ne})})}},8513:e=>{editorConfig={plugins:"image link charmap advlist lists paste hr noneditable",toolbar:"fontsizeselect | bold italic underline strikethrough | undo redo | alignleft aligncenter alignright | bullist numlist | hr link",setup:function(e){}},e.exports=editorConfig},6973:()=>{}}]);
//# sourceMappingURL=594.e91c5159.chunk.js.map