"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[183],{5183:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Ze});var r=n(4586),o=n(6330),i=n(9399),a=n(9347),l=n(689),u=n(9367),c=n(7904),d=n(6650),s=n(8111),f=n(8389),p=n(2571),g=n(3717),h=n(575),y=/https?:\/\/(?:www\\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&\/=]*)/gi,x=function(e){return function(e,t){for(var n,r=t,o=0,i=[];null!=(n=new RegExp(e).exec(r));){i.push({index:o,str:r.substring(0,n.index)});var a=n.index+n[0].length;i.push({index:o+n.index,str:r.substring(n.index,a)}),o+=a,r=r.substring(a)}return i.push({index:o,str:r}),i}(y,e).filter((function(e,t){return t%2==1})).map((function(e){return e.str}))};const m=function(e){var t=e.link,n=e.isMobile;return(0,h.jsx)(d.View,{style:{borderRadius:6,marginVertical:10,marginHorizontal:8},children:(0,h.jsxs)(g.default,{onPress:function(){return p.default.openURL(t.url)},onLongPress:function(){},style:{width:"100%",flexDirection:"row"},children:[t.imageUrl?(0,h.jsx)(f.default,{source:{uri:t.imageUrl},resizeMode:"cover",style:{borderRadius:6,width:"100%",maxWidth:n?120:160,maxHeight:n?120:160,borderWidth:1}}):void 0,(0,h.jsxs)(d.View,{style:{flex:1,marginHorizontal:20,overflow:"hidden",minHeight:n?90:120},children:[(0,h.jsx)(d.Text,{style:{fontSize:18},numberOfLines:1,children:t.title}),(0,h.jsx)(d.Text,{style:{fontSize:14},numberOfLines:7,ellipsizeMode:"head",children:t.description}),(0,h.jsx)(d.Text,{style:{fontSize:12},numberOfLines:1,children:t.url})]})]})})};var v=n(8594),b=(0,v.axiosCreate)("feedynote"),j=function(){var e=(0,o.default)((function*(e){return(yield b.get(`/api/v1/content/${e}`)).data}));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=(0,o.default)((function*(e,t){var n=void 0!==e?`&parentId=${e}`:"",r=void 0!==t?`&type=${t}`:"";return(yield b.get(`/api/v1/content?self=true&size=256${n}${r}`)).data.value}));return function(t,n){return e.apply(this,arguments)}}(),O=function(){var e=(0,o.default)((function*(e,t,n){var r=e<1?"":`&parentId=${e}`,o="NOTEV2"===t?"256":"20";return{current:(yield b.get(`/api/v1/content?self=true&sort=id,DESC&size=${o}&page=${n}${r}`)).data.value}}));return function(t,n,r){return e.apply(this,arguments)}}(),S=function(){var e=(0,o.default)((function*(e){return(yield b.post("/api/v1/content",e)).data.id}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=(0,o.default)((function*(e){var t=e.id,n=e.updated;yield b.patch("/api/v1/content",{ids:[t],updated:n})}));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=(0,o.default)((function*(e){yield b.delete(`/api/v1/content/${e}`)}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,o.default)((function*(e){yield b.post("/api/v1/content/bulk",e)}));return function(t){return e.apply(this,arguments)}}(),E=(function(){var e=(0,o.default)((function*(e){return(yield b.post("/api/v1/cell/",e)).data}))}(),function(){var e=(0,o.default)((function*(e){var t=[];for(var n of x(e.query))t.push((yield b.get(`/api/v1/preview/autocomplete?query=${n}`)).data);return t}));return function(t){return e.apply(this,arguments)}}());function T(e,t){return(0,s.useQuery)(["ContentList",e,t],(0,o.default)((function*(){return void 0!==e||void 0!==t?yield C(e,t):void 0}))).data}function D(){var e=(0,s.useQueryClient)(),t=(0,s.useMutation)(S,{onSuccess:function(){e.invalidateQueries("ContentList")}}),n=(0,s.useMutation)(w,{onSuccess:function(){e.invalidateQueries("ContentList"),e.invalidateQueries("Content")}}),r=(0,s.useMutation)(P,{onSuccess:function(){e.invalidateQueries("ContentList")}}),o=(0,s.useMutation)(k,{onSuccess:function(){e.invalidateQueries("ContentList")}});return(0,i.useEffect)((function(){}),[]),{create:t.mutateAsync,update:n.mutateAsync,delete:r.mutateAsync,updateCells:o.mutateAsync}}var I=n(7989),R=n(3705),z=n(6927),N=(n(9850),n(863)),B=n(5888),L=n(2990),A=n(5073);var H=function(e){var t=e.time,n=(t=void 0===t?{}:t).content,r=t.style,o=e.style;return(0,h.jsx)(c.default,{style:[F.timeContainer,o],children:(0,h.jsx)(d.Text,{style:[F.time,r],children:n})})},M=function(e){var t=e.icon,n=void 0===t?{}:t,r=e.iconStyle,o=e.lineStyle,i="function"===typeof n?(0,h.jsx)(n,{styles:[F.icon,r]}):(0,h.jsx)(A.default,{icon:n.content,style:[F.icon,n.style?n.style:null]});return(0,h.jsxs)(c.default,{style:[F.iconContainer,r],children:[i,(0,h.jsx)(c.default,{style:[F.verticalLine,o]})]})},V=function(e){var t=e.children,n=e.style;return(0,h.jsx)(c.default,{style:[F.eventContainer,n],children:t})},W=function(e){var t=e.event,n=void 0===t?{}:t,r=e.eventStyle,o=e.timeContainerStyle,i=e.iconContainerStyle,a=e.lineStyle,l=e.contentContainerStyle,u=n.title,s=void 0===u?{}:u,p=n.description,y=void 0===p?{}:p,x=n.imageUrl,m=n.time,v=n.icon,b=n.pressAction,j=b?g.default:c.default,C=s&&"function"===typeof s?(0,h.jsx)(s,{styles:F.title}):(0,h.jsx)(d.Text,{style:[F.title,{fontSize:14}],children:s}),O=y&&"function"===typeof y?(0,h.jsx)(y,{styles:F.description}):(0,h.jsxs)(c.default,{style:{flexDirection:"row"},children:[x?(0,h.jsx)(f.default,{source:{uri:x},resizeMode:"cover",style:{width:"33%",maxWidth:150,minHeight:120,borderWidth:1}}):void 0,(0,h.jsx)(d.Text,{style:[F.description,{fontSize:12}],children:y})]});return(0,h.jsxs)(j,{style:[F.row,r],onPress:b,children:[(0,h.jsx)(H,{time:m,style:o}),(0,h.jsx)(M,{icon:v,iconStyle:i,lineStyle:a}),(0,h.jsxs)(V,{style:l,children:[C,O]})]})};var F=N.default.create({container:{flex:1,width:"100%"},row:{flexDirection:"row",alignItems:"flex-start",marginVertical:5},timeContainer:{flexBasis:"15%",paddingTop:10},time:{fontSize:12,color:"#888",fontStyle:"italic",textAlign:"center"},iconContainer:{flexBasis:"5%",alignItems:"center",alignSelf:"stretch",marginHorizontal:"5%"},verticalLine:{flex:1,width:1,backgroundColor:"#ccc"},eventContainer:{flexBasis:"65%",flexGrow:1,alignItems:"flex-start",padding:16,borderRadius:15,shadowOffset:{width:B.default.isRTL?8:-8,height:0},shadowColor:"#888",shadowOpacity:.2,marginBottom:10,borderTopLeftRadius:0},icon:{textAlign:"center",width:20,height:20,backgroundColor:"#6F98FA",paddingTop:"ios"===L.default.OS?2.5:5,borderRadius:10,fontSize:9,overflow:"hidden",borderWidth:3,borderColor:"#e0e9ff"},title:{fontSize:12,fontWeight:"bold",textAlign:"left",marginBottom:5,lineHeight:20},description:{textAlign:"left",fontSize:11,lineHeight:18,paddingBottom:10}}),U=n(3775);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var G=(new Date).getTimezoneOffset(),Q=function(e){var t=new Date(e);t.setMinutes(t.getMinutes()-G);var n=t.toISOString().slice(0,16),r=n.slice(0,10);return r==(new Date).toISOString().slice(0,10)?n.slice(11):r},_=i.memo((function(e){return e.data.map((function(e){return K(K({},e),{},{time:{content:Q(e.updated)},pressAction:function(){return(0,a.navigate)("NoteScreen",{id:e.id})}})})).map((function(e,t){return(0,h.jsx)(W,{event:e},t)}))})),X=function(e){return e?20:4},J=function(e){return e?230:190},q=i.memo((function(e){var t,n=e.data,r=(0,d.useResizeContext)(),o=J("landscape"===r),i="landscape"===r?2:0;return null==(t=[].concat((0,R.default)(n.sort((function(e,t){return e.updated<t.updated?1:-1}))),[null,null]))?void 0:t.map((function(e,t){if(null===e)return(0,h.jsx)(c.default,{style:{flexBasis:"landscape"===r?"33%":"50%",maxWidth:o}},t);var n=e.description,l=function(){return(0,a.navigate)("NoteScreen",{id:e.id})};return(0,h.jsxs)(g.default,{style:{flexBasis:"landscape"===r?"33%":"50%",padding:X("landscape"===r),paddingRight:0,minWidth:o,maxWidth:o},onPress:l,children:[(0,h.jsx)(U.default,{onPress:l,style:{aspectRatio:1/Math.sqrt(2),borderRadius:6,marginVertical:10,marginHorizontal:8,overflow:"hidden"},children:(0,h.jsx)(U.default.Content,{children:(0,h.jsx)(d.Text,{style:{fontSize:12+i,opacity:.4},children:n})})}),(0,h.jsxs)(c.default,{style:{flexDirection:"row",marginTop:10,justifyContent:"space-between",alignItems:"center",width:"100%"},children:[(0,h.jsx)(d.Text,{style:{fontSize:14+i},children:e.title}),(0,h.jsx)(d.Text,{style:{fontSize:12+i,opacity:.4,textAlign:"right"},children:Q(e.updated)})]})]},t)}))}));const Z=function(e){var t=e.parentContent,n=function(e,t){var n=(0,s.useInfiniteQuery)(["ContentList",e],function(){var n=(0,o.default)((function*(n){var r=n.pageParam;return yield O(e,t,r)}));return function(e){return n.apply(this,arguments)}}(),{select:function(e){return e.pages.length>1&&(e.pages[e.pages.length-2].next=e.pages[e.pages.length-1]),e},getNextPageParam:function(e,t){return t.length},refetchOnReconnect:!1});return{data:n.data,fetchNextPage:n.fetchNextPage}}(t.id,t.type),r=n.data,i=n.fetchNextPage,a=(0,d.useResizeContext)();return r&&("NOTEV2"!==t.type?(0,h.jsx)(z.default,{data:r.pages,renderItem:function(e){var t=e.item;return(0,h.jsx)(_,{data:t.current})},style:{height:0},onEndReached:function(){i()}}):(0,h.jsx)(u.default,{style:{height:0},contentContainerStyle:{flexDirection:"row",justifyContent:"center"},children:(0,h.jsx)(c.default,{style:{backgroundColor:"transparent",flexBasis:"100%",maxWidth:(J("landscape"===a)+5)*("landscape"===a?5:3),flexWrap:"wrap",flexDirection:"row",paddingRight:X("landscape"===a),justifyContent:"landscape"===a?void 0:"center"},children:r.pages.map((function(e,t){return(0,h.jsx)(q,{data:e.current},t)}))})}))};function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=n(3780),ne=n(5346),re=n(2330),oe=n(8397),ie=n(4426),ae=n(3390);const le=function(e){var t=e.value,n=e.onChangeText,r=e.style,o=e.placeholder,a=e.autoCapitalize,u=void 0===a?"none":a,c=e.autoCorrect,d=void 0!==c&&c,s=e.minHeight,f=void 0===s?40:s,p=e.maxHeight,g=void 0===p?200:p,y=(0,i.useState)(f),x=(0,l.default)(y,2),m=x[0],v=x[1];return(0,h.jsx)(ae.default,{multiline:!0,value:t,onChangeText:n,onContentSizeChange:function(e){var t=e.nativeEvent.contentSize.height,n=Math.max(f,Math.min(t,g));v(n)},style:[r,{height:m,textAlignVertical:"top"}],scrollEnabled:m>=g,placeholder:o,autoCapitalize:u,autoCorrect:d})};function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var de,se,fe,pe,ge;if("android"===L.default.OS||"ios"===L.default.OS){var he={};de=he.default,se=he.ScaleDecorator}else fe=n(2372),pe=n(7660),ge=n(489);var ye=function(e){var t=e.item,n=e.code,r=e.renderCellContent,o=pe.useSortable({id:n}),i=o.attributes,a=o.listeners,l=o.setNodeRef,u=o.transform,c=o.transition,d=o.isDragging,s={transform:ge.CSS.Transform.toString(u?{x:u.x,y:u.y,scaleX:1,scaleY:1}:null),transition:c,opacity:d?.5:1,position:"relative",flex:1,zIndex:d?1:0};return(0,h.jsxs)("div",{ref:l,style:s,children:[(0,h.jsx)("div",ce(ce(ce({},i),a),{},{style:{cursor:"move",width:40,position:"absolute",height:"100%",zIndex:10,left:0,top:0}})),r({item:t})]})},xe=function(e){var t=e.items,n=e.onSortEnd,r=e.renderCellContent,o=e.getId,a=(0,i.useState)(t.map((function(e){return""+o(e)}))),u=(0,l.default)(a,2),d=u[0],s=u[1];(0,i.useEffect)((function(){t.length!==d.length&&s((function(e){return t.map((function(t,n){return n<e.length?e[n]:""+o(t)})).slice(0,t.length)}))}),[t]);var f=fe.useSensors(fe.useSensor(fe.PointerSensor,{activationConstraint:{distance:8}}),fe.useSensor(fe.KeyboardSensor,{coordinateGetter:pe.sortableKeyboardCoordinates}));return(0,h.jsx)(fe.DndContext,{sensors:f,collisionDetection:fe.closestCenter,onDragEnd:function(e){var r=e.active,o=e.over;if(o&&r.id!==o.id){var i=d.findIndex((function(e){return e===r.id})),a=d.findIndex((function(e){return e===o.id})),l=pe.arrayMove(Array.from(Array(t.length).keys()),i,a);s((function(e){return pe.arrayMove(e,i,a).map((function(e,t){return t>l[t]?"@"+e:e}))})),n(pe.arrayMove(t,i,a))}},children:(0,h.jsx)(pe.SortableContext,{items:d,strategy:pe.verticalListSortingStrategy,children:(0,h.jsx)(c.default,{style:me.cellsList,children:t.map((function(e,t){var n=d[t]||""+o(e);return(0,h.jsx)(ye,{code:n,item:e,renderCellContent:r},n)}))})})})},me=N.default.create({cellsList:{paddingVertical:10,paddingHorizontal:5}});const ve=function(e){var t=e.data,n=e.setData,r=e.getId,o=e.renderItem;return"android"===L.default.OS||"ios"===L.default.OS?(0,h.jsx)(de,{data:t,onDragEnd:function(e){var t=e.data;return n(t)},keyExtractor:function(e){return e.id.toString()},renderItem:function(e){var t=e.item,n=e.drag;e.isActive;return(0,h.jsx)(se,{children:(0,h.jsxs)(c.default,{style:{flexDirection:"row"},children:[(0,h.jsx)(g.default,{onLongPress:n,style:{width:40,justifyContent:"center",alignItems:"center"},children:(0,h.jsx)(re.default,{name:"drag-handle",size:20,color:"#888"})}),(0,h.jsx)(c.default,{style:{flex:1},children:o(t)})]})})},contentContainerStyle:me.cellsList}):(0,h.jsx)(xe,{items:t,getId:r,onSortEnd:n,renderCellContent:o})};function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ce=function(e){return e.IDLE="idle",e.RUNNING="running",e.COMPLETED="completed",e.ERROR="error",e}(Ce||{}),Oe={EDITOR:{executable:!1,init:function(e){return""},iconName:"edit",iconSize:18},LINK:{executable:!0,init:function(e){return"https://"},iconName:"link",iconSize:20},MARKDOWN:{executable:!1,init:function(e){return"# Welcome to Jupyter Notebook in React Native\n\nThis is a basic implementation of Jupyter Notebook using React Native and TypeScript. You can:\n\n- Write and edit markdown cells\n- Write and execute JavaScript code\n- Reorder cells by dragging them"},iconName:"text-fields",iconSize:20}},Se=function(e){var t=e.theme,n=e.item,r=e.isSelected,o=e.heightRef,i=e.setCells,a=e.executeCell,l=e.setSelectedCellId,u=Te(t),d=u.styles,s=u.markdownStyles,f=function(e,t){i((function(n){return n.map((function(n){return n.id===e?je(je({},n),{},{content:t}):n}))}))};return(0,h.jsxs)(c.default,{style:[d.cellContainer,{minHeight:o.current[n.id]},r&&d.selectedCell],onLayout:function(e){o.current[n.id]=e.nativeEvent.layout.height},children:[(0,h.jsxs)(c.default,{style:d.cellHandle,children:[Oe[n.type].executable&&(0,h.jsx)(c.default,{style:d.executionCount,children:(0,h.jsx)(ne.default,{style:d.executionCountText,children:n.executionCount?`[${n.executionCount}]`:"[ ]"})}),(0,h.jsx)(re.default,{name:"drag-handle",size:20,color:"#888"})]}),(0,h.jsxs)(c.default,{style:d.cellContent,children:[(0,h.jsxs)(c.default,{style:d.cellToolbar,children:[(0,h.jsx)(g.default,{style:d.toolbarButton,onPress:function(){return l(n.id)},children:(0,h.jsx)(re.default,{name:Oe[n.type].iconName,size:Oe[n.type].iconSize,color:"#2196F3"})}),(0,h.jsx)(g.default,{style:d.toolbarButton,onPress:function(){return a(n.id)},disabled:!Oe[n.type].executable,children:(0,h.jsx)(re.default,{name:"play-arrow",size:20,color:Oe[n.type].executable?"#4CAF50":"#ccc"})}),(0,h.jsx)(g.default,{style:d.toolbarButton,onPress:function(){return e=n.id,void i((function(t){return t.filter((function(t){return t.id!==e}))}));var e},children:(0,h.jsx)(re.default,{name:"delete",size:20,color:"#F44336"})})]}),(0,h.jsxs)(g.default,{activeOpacity:1,onPress:function(){return l(n.id)},style:d.cellInputContainer,children:["EDITOR"===n.type&&(0,h.jsxs)(c.default,{children:[(0,h.jsx)(ie.EditorViewer,{theme:t,value:n.content,autoResize:!0,active:!r,onPress:function(){return l(n.id)}}),(0,h.jsx)(ie.Editor,{theme:t,value:n.content,autoResize:!0,active:r,setValue:function(e){return f(n.id,e)}})]}),"LINK"===n.type&&(0,h.jsx)(le,{style:d.codeInput,value:n.content,onChangeText:function(e){return f(n.id,e)},autoCapitalize:"none",autoCorrect:!1}),"MARKDOWN"===n.type&&(r?(0,h.jsx)(le,{style:d.markdownInput,value:n.content,onChangeText:function(e){return f(n.id,e)},autoCapitalize:"none",autoCorrect:!1}):(0,h.jsx)(oe.default,{style:s,children:n.content}))]}),n.status===Ce.COMPLETED?(0,h.jsx)(h.Fragment,{children:Oe[n.type].executable&&JSON.parse(n.output).map((function(e,t){return(0,h.jsx)(m,{link:e,isMobile:!1},t)}))}):n.status===Ce.ERROR&&(0,h.jsx)(c.default,{style:[d.outputContainer,d.errorOutput],children:(0,h.jsx)(ne.default,{style:d.outputText,children:n.output})})]})]})},we={light:{background:"#f8f8f8",text:"#111",codeText:"#333",codeBackground:"#f8f8f8",outerBackground:"#fff",border:"#e0e0e0",selectedBorder:"#3F51B5",error:"rgba(244, 67, 54, 0.1)",markdownHead:"#2C3E50",markdownCode:"#f5f5f5",LINK:"#4CAF50",MARKDOWN:"#2196F3",EDITOR:"goldenrod"},dark:{background:"#1E1E1E",text:"#E0E0E0",codeText:"#B0B0B0",codeBackground:"#2A2A2A",outerBackground:"#121212",border:"3A3A3A",selectedBorder:"#4A90E2",error:"rgba(244, 67, 54, 0.2)",markdownHead:"#A0B9D0",markdownCode:"#1E1E1E",LINK:"#2E7D32",MARKDOWN:"#1565C0",EDITOR:"darkgoldenrod"}},Pe=function(e){return{styles:N.default.create({container:{flex:1,backgroundColor:we[e].outerBackground},header:je({backgroundColor:we[e].background,flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:15},"web"!==L.default.OS&&{elevation:4}),title:{color:we[e].text,fontSize:20,fontWeight:"bold"},headerButtonText:{color:we[e].codeText,marginLeft:5,fontWeight:"500"},cellContainer:{flexDirection:"row",borderTopLeftRadius:6,borderBottomLeftRadius:6,backgroundColor:we[e].background,overflow:"hidden",borderColor:we[e].border,padding:1},selectedCell:{borderColor:we[e].selectedBorder,borderWidth:2,padding:0},draggingCell:{opacity:.7,backgroundColor:we[e].background},cellHandle:{width:40,backgroundColor:we[e].codeBackground,alignItems:"center",paddingTop:15},cellContent:{flex:1,borderWidth:1,margin:10,marginVertical:5,borderColor:we[e].border},cellToolbar:{flexDirection:"row",padding:5,paddingVertical:0,borderBottomColor:we[e].border},codeInput:{fontFamily:"monospace",minHeight:40,color:we[e].text,backgroundColor:we[e].background},markdownInput:{minHeight:40,color:we[e].text,backgroundColor:we[e].background},outputContainer:{backgroundColor:we[e].codeBackground,padding:10,borderTopWidth:1,borderTopColor:we[e].border},errorOutput:{backgroundColor:we[e].error},outputText:{fontFamily:"monospace",color:we[e].codeText},addCellContainer:{flexDirection:"row",justifyContent:"center",padding:15,borderTopWidth:1,borderTopColor:we[e].border,backgroundColor:we[e].outerBackground,zIndex:-1},headerButtons:{flexDirection:"row",alignItems:"center",paddingHorizontal:12,paddingVertical:6,borderRadius:4},executionCount:{alignItems:"center",marginBottom:10},toolbarButton:{padding:5,marginRight:10},cellInputContainer:{padding:0,paddingHorizontal:5},addCellButton:{flexDirection:"row",alignItems:"center",paddingHorizontal:16,paddingVertical:8,borderRadius:4,marginHorizontal:5},addCellButtonText:{color:"#fff",marginLeft:5,fontWeight:"500"},executionCountText:{color:"#888",fontSize:12}}),markdownStyles:{body:{fontSize:14,color:we[e].codeText},heading1:{fontSize:24,marginTop:10,marginBottom:10,fontWeight:"bold",color:we[e].markdownHead},heading2:{fontSize:20,marginTop:10,marginBottom:10,fontWeight:"bold",color:we[e].markdownHead},code_inline:{backgroundColor:we[e].markdownCode,padding:2,borderRadius:3,fontFamily:"monospace"},code_block:{backgroundColor:we[e].markdownCode,padding:10,borderRadius:3,fontFamily:"monospace"}}}},ke=Pe("light"),Ee=Pe("dark"),Te=function(e){return"light"===e?ke:Ee};const De=function(e){var t=(0,d.useColorScheme)(),n=(0,d.useLangContext)().lang,r=(0,i.useState)(e.init.map((function(e,t){return je(je({},e),{},{id:`${t}`,status:e.status||Ce.IDLE})}))),a=(0,l.default)(r,2),u=a[0],s=a[1],f=(0,i.useState)(null),p=(0,l.default)(f,2),y=p[0],x=p[1],m=(0,i.useState)(1),v=(0,l.default)(m,2),b=v[0],j=v[1],C=(0,i.useRef)({});(0,i.useEffect)((function(){e.cellRef.current={cells:u,executeAllCells:function(){var e=(0,o.default)((function*(){for(var e of u)Oe[e.type].executable&&(yield O(e.id))}));return function(){return e.apply(this,arguments)}}()}}),[u]);var O=function(){var e=(0,o.default)((function*(e){s((function(t){return t.map((function(t){return t.id===e?je(je({},t),{},{status:Ce.RUNNING}):t}))}));var t,n,r=u.find((function(t){return t.id===e}));if(r&&!1!==Oe[r.type].executable)try{var o=yield(t=r.type,n=r.content,new Promise((function(e,r){try{"LINK"===t?e(E({query:n}).then((function(e){return JSON.stringify(e)}))):"MARKDOWN"===t?console.log("TEMP"):e("")}catch(o){r(`Error: ${o}`)}})));s((function(t){return t.map((function(t){return t.id===e?je(je({},t),{},{output:o,executionCount:b,status:Ce.COMPLETED}):t}))})),j((function(e){return e+1}))}catch(i){s((function(t){return t.map((function(t){return t.id===e?je(je({},t),{},{output:String(i),executionCount:b,status:Ce.ERROR}):t}))})),j((function(e){return e+1}))}}));return function(t){return e.apply(this,arguments)}}(),S=(0,i.useCallback)((function(e){var n=e.item;return(0,h.jsx)(Se,{theme:t,item:n,isSelected:y===n.id,heightRef:C,setCells:s,executeCell:O,setSelectedCellId:x})}),[y,u]),w=Te(t).styles;return(0,h.jsxs)(te.default,{style:w.container,children:[(0,h.jsx)(ve,{data:u,setData:s,getId:function(e){return e.id},renderItem:S}),(0,h.jsx)(c.default,{style:w.addCellContainer,children:Object.entries(Oe).map((function(e,r){var o=(0,l.default)(e,2),i=o[0],a=o[1],c={backgroundColor:we[t][i]};return(0,h.jsxs)(g.default,{style:[w.addCellButton,c],onPress:function(){return function(e){var t={id:Date.now().toString(),type:e,content:Oe[e].init(u),output:"",executionCount:null,status:Ce.IDLE};s((function(e){return[].concat((0,R.default)(e),[t])}))}(i)},children:[(0,h.jsx)(re.default,{name:a.iconName,size:a.iconSize,color:"#fff"}),(0,h.jsx)(ne.default,{style:w.addCellButtonText,children:n(i)})]},r)}))})]})};function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ze=n(205),Ne=n(5589),Be=n(7687),Le=n(6579);function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Me=function(e){var t=T(0,e.type),n=(0,d.useLangContext)().lang,r=(0,d.useResizeContext)(),o="landscape"===r?5:8;return(0,h.jsxs)(ze.default,{children:[(0,h.jsxs)(d.View,{style:{flexDirection:"row"},children:[(0,h.jsx)(Ne.default,{style:{flex:1},selectable:!1,children:n("Notes")}),(0,h.jsx)(Be.default,{style:{position:"absolute",right:0},onPress:function(){return(0,a.navigate)("ContentListScreen",{type:e.type})},children:(0,h.jsx)(A.default,{icon:"plus",style:{margin:o}})})]}),t&&t.map((function(e){return(0,h.jsx)(Le.default,{left:function(e){return(0,h.jsx)(A.default,He(He({},e),{},{icon:"notebook"}))},title:e.title,onPress:function(){return(0,a.navigate)("ContentListScreen",{id:e.id})},style:{padding:o}},e.id)}))]})};var Ve=function(){var e=(0,d.useColorScheme)();return(0,h.jsx)(u.default,{style:{flex:1,backgroundColor:d.Colors[e].background},children:(0,h.jsx)(Me,{type:"NOTEV2"})})},We=function(){var e=(0,d.useColorScheme)();return(0,h.jsx)(u.default,{style:{flex:1,backgroundColor:d.Colors[e].background},children:(0,h.jsx)(a.ConfigSections,{})})};var Fe={HomeScreen:{title:"home",component:function(e){e.navigation,e.route;var t=(0,d.useLangContext)().lang,n=(0,d.useColorScheme)(),r=d.Colors[n].text,o=[{title:t("Contents"),component:Ve,icon:(0,h.jsx)(A.default,{icon:"table-of-contents"}),headerRight:function(){return(0,h.jsx)(h.Fragment,{})}},{title:t("Config"),component:We,icon:(0,h.jsx)(A.default,{icon:"dots-horizontal"}),headerRight:function(){return(0,h.jsx)(h.Fragment,{})}}];return(0,h.jsx)(a.HomeSection,{tabViews:o,title:t("home"),children:(0,h.jsxs)(c.default,{style:{flexGrow:1,width:"80%",marginTop:72},children:[(0,h.jsx)(d.Text,{style:{fontSize:32,color:r},children:"feedynote"}),(0,h.jsx)(c.default,{style:{backgroundColor:d.Colors.borderColor,height:1,width:"100%"}}),(0,h.jsx)(c.default,{style:{height:24}}),(0,h.jsx)(a.ConfigSections,{})]})})},path:"home"},NoteScreen:{path:"notes",title:"notes",component:function(e){var t,n,r,f,p,g=e.navigation,y=e.route,x={created:void 0===(null==y||null==(t=y.params)?void 0:t.id),id:parseInt(null==y||null==(n=y.params)?void 0:n.id),parentId:void 0!==(null==y||null==(r=y.params)?void 0:r.parentId)?parseInt(null==y||null==(f=y.params)?void 0:f.parentId):void 0},m=(0,i.useRef)(),b=(0,d.useLangContext)().lang,C=(0,v.useAuthContext)().auth,O=(p=x.created?void 0:x.id,(0,s.useQuery)(["Content",p],(0,o.default)((function*(){return p?yield j(p):void 0}))).data),S=T(x.created?void 0:x.id),w=(0,i.useMemo)((function(){var e;return null==(e=x.created?[]:S)?void 0:e.map((function(e){return{type:e.type,content:e.title,output:e.description||"",executionCount:e.option.EXECUTION_COUNT?parseInt(e.option.EXECUTION_COUNT,10):null,status:e.option.EXECUTION_STATUS}}))}),[S]),P=D(),k=(0,i.useState)(),E=(0,l.default)(k,2),R=E[0],z=E[1],N=(0,i.useState)(!1),B=(0,l.default)(N,2),L=B[0],A=B[1],H=function(){if(C.user){var e,t=m.current?m.current.cells.map((function(e,t){var n=(0,ie.toRaw)(e.content).replaceAll(/\r\n/g,"");return n.length>32&&(n=n.substring(0,30)+"..."),n})).join("\r\n"):"";return x.created?e=P.create({userId:C.user.id,parentId:x.parentId,type:"PAGE",order:0,title:R||"",description:t,option:{}}).then((function(e){return(0,a.navigate)("NoteScreen",{id:e}),e})):void 0!==O&&(e=P.update({id:O.id,updated:Re(Re({},O),{},{title:R||O.title,description:t})}).then((function(){return x.id}))),e}},M=function(){var e=H();null==e||e.then((function(e){var t,n=null==(t=C.user)?void 0:t.id,r=n&&m.current?m.current.cells.map((function(t,r){return{userId:n,parentId:e,type:t.type,order:r,description:t.output,title:t.content,option:{EXECUTION_COUNT:null!==t.executionCount?`${t.executionCount}`:void 0,EXECUTION_STATUS:t.status}}})):[],o=void 0!==S?S.map((function(e){return e.id})):[];return P.updateCells({created:r,deleteIds:o})}))};(0,i.useLayoutEffect)((function(){x.created?(A(!1),z(b("New Page"))):O&&(A(!1),z(O.title))}),[O]),(0,i.useLayoutEffect)((function(){(x.created||O)&&g.setOptions({title:R,headerRight:function(){return(0,h.jsxs)(c.default,{style:{flexDirection:"row"},children:[(0,h.jsx)(d.CommonButton,{title:"\u270f\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return A(!0)}}),(0,h.jsx)(d.CommonButton,{title:b("save"),onPress:M,style:{paddingTop:8,marginRight:10}}),O&&(0,h.jsx)(d.CommonButton,{title:"\ud83d\uddd1\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return P.delete(O.id).then((function(e){return V()}))}})]})},headerShown:!L})}),[g,O,S,R,L]);var V=function(){g.canGoBack()?g.goBack():g.navigate("HomeScreen",{tab:1})};return(0,h.jsxs)(d.View,{style:{width:"100%",height:"100%"},children:[L&&(0,h.jsxs)(h.Fragment,{children:[void 0!==R&&(0,h.jsx)(I.default,{mode:"outlined",value:R,onChangeText:z,style:{borderRadius:20,margin:1}}),(0,h.jsx)(d.CommonButton,{title:b("save"),onPress:H,style:{height:65,paddingVertical:20}}),(0,h.jsx)(d.CommonButton,{title:b("cancel"),onPress:function(){return A(!1)},style:{height:65,paddingVertical:20}}),O&&(0,h.jsx)(d.CommonButton,{title:b("delete"),textStyle:{color:"red"},style:{height:65,paddingVertical:20},onPress:function(){return P.delete(O.id).then((function(e){return V()}))}})]}),(0,h.jsx)(u.default,{style:{flex:1},contentContainerStyle:{flexGrow:1},children:void 0!==w&&(0,h.jsx)(De,{init:w,cellRef:m})})]})}},ContentListScreen:{path:"contents",title:"contents",component:function(e){var t,n,r,o,s=e.navigation,f=e.route,p={created:void 0===(null==f||null==(t=f.params)?void 0:t.id),id:"*"===(null==f||null==(n=f.params)?void 0:n.id)?"*":parseInt(null==f||null==(r=f.params)?void 0:r.id),type:null==f||null==(o=f.params)?void 0:o.type},g=(0,d.useLangContext)().lang,y=(0,v.useAuthContext)().auth,x=T(0),m=D(),b=p.created||null==x?void 0:x.find((function(e){return e.id===p.id})),j=(0,i.useState)(),C=(0,l.default)(j,2),O=C[0],S=C[1],w=(0,i.useState)(!1),P=(0,l.default)(w,2),k=P[0],E=P[1],R=p.created?p.type:null==b?void 0:b.type,z=function(){s.canGoBack()?s.goBack():s.navigate("HomeScreen",{tab:1})},N={NOTEV2:g("New Note")},B=function(){E(!0)};(0,i.useLayoutEffect)((function(){p.created?(E(!1),S(N[p.type])):b&&(E(!1),S(b.title))}),[b,R]),(0,i.useLayoutEffect)((function(){p.created?s.setOptions({headerShown:!1}):s.setOptions({title:(null==b?void 0:b.title)||g("All Timelines"),headerRight:function(){return(0,h.jsxs)(c.default,{style:{flexDirection:"row"},children:["NOTEV2"===(null==b?void 0:b.type)&&(0,h.jsx)(d.CommonButton,{title:"\u2295",style:{height:40,paddingTop:8,marginRight:10},onPress:function(){return(0,a.navigate)("NoteScreen",{parentId:b.id})}}),b&&!p.created&&(0,h.jsx)(d.CommonButton,{title:"\u270f\ufe0f",style:{height:40,paddingTop:8,marginRight:10},onPress:B})]})},headerShown:!k})}),[s,b,R,k]);var L=p.created||k;return(0,h.jsx)(d.View,{style:{width:"100%",height:"100%",backgroundColor:"transparent"},children:L?(0,h.jsxs)(h.Fragment,{children:[void 0!==O&&(0,h.jsx)(I.default,{mode:"outlined",value:O,onChangeText:S,style:{borderRadius:20,margin:1}}),(0,h.jsx)(d.CommonButton,{title:g("save"),onPress:function(){var e;if(y.user&&void 0!==O&&(null==b?void 0:b.title)!==O&&void 0!==R){var t;if(p.created){var n=null==x?void 0:x.filter((function(e){return e.type==p.type}));t=m.create({userId:y.user.id,parentId:0,type:R,order:((null==n?void 0:n.length)||0)+1,title:O,option:{}}).then((function(e){(0,a.navigate)("ContentListScreen",{id:e})}))}else void 0!==b&&(t=m.update({id:b.id,updated:ee(ee({},b),{},{type:R,title:O})}));null==(e=t)||e.then((function(){E(!1)}))}else E(!1)},style:{height:65,paddingVertical:20}}),(0,h.jsx)(d.CommonButton,{title:g("cancel"),onPress:p.created?z:function(){return E(!1)},style:{height:65,paddingVertical:20}}),b&&(0,h.jsx)(d.CommonButton,{title:g("delete"),textStyle:{color:"red"},style:{height:65,paddingVertical:20},onPress:function(){return m.delete(b.id).then((function(e){return z()}))}})]}):(0,h.jsx)(u.default,{style:{flex:1},contentContainerStyle:{flexGrow:1},children:b&&(0,h.jsx)(Z,{parentContent:b})})})}}};function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Ke=function(){var e=(0,d.useLangContext)().lang;return(0,h.jsxs)(u.default,{style:{flex:1},children:[(0,h.jsx)(Le.default,{left:function(e){return(0,h.jsx)(A.default,$e($e({},e),{},{icon:"home"}))},title:e("Home"),onPress:function(){return(0,a.navigate)("HomeScreen")}}),(0,h.jsx)(Me,{type:"NOTEV2"})]})};var Ge=n(8610),Qe=n(7650),_e=n(910);function Xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xe(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qe=function(){var e=(0,o.default)((function*(){var e=yield Promise.all([n.e(928),n.e(973)]).then(n.bind(n,9928));return{main:Fe,login:a.login,prefixes:[e.makeUrl("/")],rootPath:"feedynote",documentTitle:{formatter:function(){return"feedynote"}},rootScreen:{main:"HomeScreen",login:"LoginScreen"},headerLeftIcon:(0,h.jsx)(A.default,{icon:"backburger",style:{left:-18,top:-14}}),headerRight:(0,h.jsx)(h.Fragment,{}),modals:[],drawer:(0,h.jsx)(Ke,{})}}));return function(){return e.apply(this,arguments)}}();const Ze=function(){var e=(0,d.useColorScheme)(),t="dark"==e?Ge.MD2DarkTheme:Qe.MD2LightTheme,n=Je(Je({},t),{},{colors:Je(Je({},t.colors),{},{primary:d.Colors[e].text})}),r=i.lazy((function(){return qe().then((function(e){return{default:function(){return(0,h.jsx)(a.Navigation,{config:e})}}}))}));return(0,h.jsx)(_e.default,{theme:n,children:(0,h.jsx)(i.Suspense,{fallback:(0,h.jsx)(h.Fragment,{}),children:(0,h.jsx)(r,{})})})}}}]);
//# sourceMappingURL=183.52c92671.chunk.js.map